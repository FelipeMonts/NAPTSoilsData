g.River.4.sub<-make_ego_graph(g.River.3,2,as_ids(V(g.River.3.sub)), mode=c("all"))  ;
g.River.4.sub<-make_ego_graph(g.River.3,2,as_ids(V(g.River.3.sub)), mode=c("all"))  ;
V(g.River.4.sub[[3]])
as_long_data_frame(g.River.4.sub[[3]])
tkplot(g.River.4.sub[[3]],canvas.width=1800, canvas.height=900, layout=layout_nicely ,V(g.River.4.sub[[3]])$name, vertex.size= 2, edge.arrow.size=0.5, vertex.label.cex=1, edge.label=round(E(g.River.4.sub[[3]])$Elev.Dif,3),vertex.label.dist=1,edge.label.cex=1) ;
tkplot(g.River.4.sub[[1]],canvas.width=1800, canvas.height=900, layout=layout_nicely ,V(g.River.4.sub[[1]])$name, vertex.size= 2, edge.arrow.size=0.5, vertex.label.cex=1, edge.label=round(E(g.River.4.sub[[1]])$Elev.Dif,3),vertex.label.dist=1,edge.label.cex=1) ;
tkplot(g.River.4.sub[[2]],canvas.width=1800, canvas.height=900, layout=layout_nicely ,V(g.River.4.sub[[2]])$name, vertex.size= 2, edge.arrow.size=0.5, vertex.label.cex=1, edge.label=round(E(g.River.4.sub[[2]])$Elev.Dif,3),vertex.label.dist=1,edge.label.cex=1) ;
dim(g.River.4.sub)
str(g.River.4.sub)
lenght(g.River.4.sub)
length(g.River.4.sub)
.libPaths("C:/Felipe/SotwareANDCoding/R_Library/library")  ;
install.packages('RCurl');
install.packages('rgdal');
install.packages('GSIF');
install.packages('raster');
install.packages('plotKML');
install.packages('XML');
install.packages('lattice');
install.packages('aqp');
install.packages('soiltexturep');
if(.Platform$OS.type == "windows")
if(.Platform$OS.type == "windows")
.Platform$OS.type
## (a) FTP download:
## location of soilgrids:
sg.ftp <- "ftp://ftp.soilgrids.org/data/recent/"
library(RCurl)
library(rgdal)
library(GSIF)
library(raster)
library(plotKML)
library(XML)
library(lattice)
library(aqp)
library(soiltexture)
## (a) FTP download:
## location of soilgrids:
sg.ftp <- "ftp://ftp.soilgrids.org/data/recent/"
getURL(sg.ftp, ftp.use.epsv = FALSE, dirlistonly = TRUE)
library(XML)
library(RCurl)
install.packages('RCurl',dependencies = T);
filenames = getURL(sg.ftp, ftp.use.epsv = FALSE, dirlistonly = TRUE)
library(RCurl)
install.packages('RCurl',dependencies = T);
.libPaths("C:/Felipe/SotwareANDCoding/R_Library/library")  ;
install.packages('RCurl',dependencies = T);
library(RCurl)
getURL(sg.ftp, ftp.use.epsv = FALSE, dirlistonly = TRUE)
library(RCurl)
library("RCurl", lib.loc="C:/Felipe/SotwareANDCoding/R_Library/library")
install.packages('bitops','RCurl',dependencies = T);
.libPaths("C:/Felipe/SotwareANDCoding/R_Library/library")  ;
install.packages('bitops','RCurl',dependencies = T);
library(RCurl)
.libPaths("C:/Felipe/SotwareANDCoding/R_Library/library")  ;
.libPaths("C:/Felipe/SotwareANDCoding/R_Library/library")  ;
library(RCurl)
library(rgdal)
library(GSIF)
library(raster)
library(plotKML)
library(XML)
library(lattice)
library(aqp)
library(soiltexture)
## GDAL paths:
if(.Platform$OS.type == "windows"){
gdal.dir <- shortPathName("C:/Program files/GDAL")
gdal_translate <- paste0(gdal.dir, "/gdal_translate.exe")
gdalwarp <- paste0(gdal.dir, "/gdalwarp.exe")
gdalinfo <- paste0(gdal.dir, "/gdalinfo.exe")
} else {
gdal_translate = "gdal_translate"
gdalwarp = "gdalwarp"
gdalinfo = "gdalinfo"
}
# ##-----------------------------------
# ## Accessing data
# ##-----------------------------------
#
# ## (a) FTP download:
# ## location of soilgrids:
# sg.ftp <- "ftp://ftp.soilgrids.org/data/recent/"
# filenames = getURL(sg.ftp, ftp.use.epsv = FALSE, dirlistonly = TRUE)
# filenames = strsplit(filenames, "\r*\n")[[1]]
# filenames[1:5]
#
# ## download to a local directory:
# ORC.name <- filenames[grep(filenames, pattern=glob2rx("ORCDRC_M_sl1_250m_ll.tif$"))]
# ORC.name
# try(download.file(paste(sg.ftp, ORC.name, sep=""), ORC.name))
# ## 2.8GB Geotiff!!
#
# ## check that everything is OK:
# GDALinfo(ORC.name)
#
# ## We focus on Ghana
# wg.url <- url("http://gsif.isric.org/lib/exe/fetch.php?media=admin.af.rda")
# load(wg.url)
# proj4string(admin.af) <- "+proj=longlat +datum=WGS84"
# country.af <- as(admin.af, "SpatialLines")
# ## Ghana bounding box:
# ghana <- admin.af[admin.af$FORMAL_EN=="Republic of Ghana",]
# ghana@bbox
#
# ## load soil Africa Soil Profile DB:
# data(afsp)
# sites <- afsp$sites
# coordinates(sites) <- ~ LONWGS84 + LATWGS84
# proj4string(sites) <- "+proj=longlat +datum=WGS84"
# #af.csy = "+proj=laea +lat_0=5 +lon_0=20 +x_0=0 +y_0=0 +units=m +ellps=WGS84 +datum=WGS84"
# #sites.af <- spTransform(sites, CRS(af.csy))
#
# ## plot country and profiles
# plot(ghana, col="red", lwd=2, asp=1)
# lines(country.af)
# points(sites, pch="+")
# ## in local projection system:
# #ghana.xy <- spTransform(ghana, CRS(af.csy))
# #ghana.xy@bbox
#
# ## get only Ghana:
# te = as.vector(ghana@bbox)
# unlink("ORC_sl1_Ghana.tif")
# system(paste0(gdalwarp, ' ', ORC.name, ' ORC_sl1_Ghana.tif -te ', paste(te, collapse=" ")))
# ORCDRC_sl1_ghana <- readGDAL("ORC_sl1_Ghana.tif")
# plot(log1p(raster(ORCDRC_sl1_ghana)), col=SAGA_pal[[1]])
#### This Seems the most efficient way to extract the soils from Kyrgyzstan #######
## (b) Web Coverage Service
## location of service:
# wcs = "http://webservices.isric.org/geoserver/wcs?"
# ## create an XML file:
# l1 <- newXMLNode("WCS_GDAL")
# l1.s <- newXMLNode("ServiceURL", wcs, parent=l1)
# l1.l <- newXMLNode("CoverageName", "orcdrc_m_sl1_250m", parent=l1)
# l1
# xml.out = "ORCDRC_M_sl1.xml"
# saveXML(l1, file=xml.out)
# ## check if the layer exists:
# system(paste(gdalinfo, xml.out))
## Alternative: calculate offset and region dims:
###### Get the bounding box region for Kyrgyzstan and then get the raster files for this sections######
ContryPolygonInfo<-ogrInfo("C:/Felipe/PIHM-CYCLES/PIHM/Soils/ISRICWorldSoils/KyrgyzstanPolygonWGS84.shp") ;
raster(system.file("https://files.isric.org/soilgrids/data/recent/ACDWRB_M_ss_250m_ll.tif", package="raster"))
raster(system.file("external/test.grd", package="raster"))
system.file("https://files.isric.org/soilgrids/data/recent/ACDWRB_M_ss_250m_ll.tif")
Bounding.box
ContryPolygonInfo<-ogrInfo("C:/Felipe/PIHM-CYCLES/PIHM/Soils/ISRICWorldSoils/KyrgyzstanPolygonWGS84.shp") ;
Bounding.box<-ContryPolygonInfo$extent;
Bounding.box
install.packages("jsonlite")
require(jsonlite)
coords <- c(45.5, 37.8)
fromJSON(paste0('https://rest.soilgrids.org/query?lon=',coords[1],'&lat=',coords[2],',&attributes=BLDFIE,SLTPPT,SNDPPT,CLYPPT'), flatten = TRUE)
install.packages('tibble', dependencies = T)
install.packages('readxl', dependencies = T)
library(readxl) ;
LaserDS.data<-read_excel("Laser and Std Results for SSSAJ.xlsx", sheet="Laser Diffraction-Sieving Data") ;
#  Tell the program where the package libraries are  #####################
.libPaths("C:/Felipe/SotwareANDCoding/R_Library/library")  ;
#  Set Working directory
setwd("C:\\Felipe\\LaserDifractionSoilTextureAnalysis\\Manuscript\\Review\\Second Review") ;
#Loand And install packages
#install.packages('tibble', dependencies = T)
#install.packages('readxl', dependencies = T)
library(readxl) ;
LaserDS.data<-read_excel("Laser and Std Results for SSSAJ.xlsx", sheet="Laser Diffraction-Sieving Data") ;
View(LaserDS.data)
View(LaserDS.data)
.libPaths("C:/Felipe/SotwareANDCoding/R_Library/library")  ;
#  Set Working directory
setwd("C:\\Felipe\\LaserDifractionSoilTextureAnalysis\\Manuscript\\Review\\Second Review") ;
#Loand And install packages
#install.packages('tibble', dependencies = T)
#install.packages('readxl', dependencies = T)
library(readxl) ;
library(XLConnect) ;
LaserDS.data<-read_excel("Laser and Std Results for SSSAJ.xlsx", sheet="Laser Diffraction-Sieving Data") ;
getwd()
LassDiff.1<-read.xlsx("../Manuscript/USDA Standards_PSA_Mastersizer_Felipe_20180824.xlsx", sheet="correct (6) fraction",startRow=5, colNames=F, rows=c(5:104),skipEmptyCols=F) ;
library(XLConnect) ;
LassDiff.1<-read_excel("../Manuscript/USDA Standards_PSA_Mastersizer_Felipe_20180824.xlsx", sheet="correct (6) fraction",startRow=5, colNames=F, rows=c(5:104),skipEmptyCols=F) ;
LassDiff.1<-read_excel("../Manuscript/USDA Standards_PSA_Mastersizer_Felipe_20180824.xlsx") #, sheet="correct (6) fraction",startRow=5, colNames=F, rows=c(5:104),skipEmptyCols=F) ;
LassDiff.1<-read_excel("C:/Felipe/LaserDifractionSoilTextureAnalysis/Manuscript/USDA Standards_PSA_Mastersizer_Felipe_20180824.xlsx") #, sheet="correct (6) fraction",startRow=5, colNames=F, rows=c(5:104),skipEmptyCols=F) ;
library(readxl) ;
library(XLConnect) ;
library(openxlsx) ;
LassDiff.1<-read.xlsx("C:/Felipe/LaserDifractionSoilTextureAnalysis/Manuscript/USDA Standards_PSA_Mastersizer_Felipe_20180824.xlsx", sheet="correct (6) fraction",startRow=5, colNames=F, rows=c(5:104),skipEmptyCols=F) ;
View(LassDiff.1)
View(LassDiff.1)
LassDiff.name<-read.xlsx("C:/Felipe/LaserDifractionSoilTextureAnalysis/Manuscript/USDA Standards_PSA_Mastersizer_Felipe_20180824.xlsx", sheet="correct (6) fraction",startRow=2, colNames=F, rows=c(2)) ;
LassDiff.1<-read.xlsx("C:/Felipe/LaserDifractionSoilTextureAnalysis/Manuscript/USDA Standards_PSA_Mastersizer_Felipe_20180824.xlsx", sheet="correct (6) fraction",startRow=5, colNames=F, rows=c(5:104),skipEmptyCols=F) ;
tail(LassDiff.1)
str(LassDiff.1)
names(LassDiff.1)<-c('Row','Size', 'nothing' ,sapply(strsplit(as.character(LassDiff.name[1,]),"/"),"[", 1))
head(LassDiff.1)
tail(LassDiff.1)
LassDiff.name
LaserDS.data<-read.excel("./Review/Second Review/Laser and Std Results for SSSAJ.xlsx", sheet="Laser Diffraction-Sieving Data") ;
LaserDS.data<-read.xlsx("./Review/Second Review/Laser and Std Results for SSSAJ.xlsx", sheet="Laser Diffraction-Sieving Data") ;
setwd("C:\\Felipe\\LaserDifractionSoilTextureAnalysis\\Manuscript") ;
LaserDS.data<-read.xlsx("./Review/Second Review/Laser and Std Results for SSSAJ.xlsx", sheet="Laser Diffraction-Sieving Data") ;
LaserDS.data<-read.xlsx("./Review/Second Review/Laser and Std Results for SSSAJ.xlsx", sheet="Laser Diffraction-Sieving Data", colNames=T) ;
names(LaserDS.data)
LassDiff.1<-read.xlsx("C:/Felipe/LaserDifractionSoilTextureAnalysis/Manuscript/USDA Standards_PSA_Mastersizer_Felipe_20180824.xlsx", sheet="correct (6) fraction",startRow=5, colNames=F, rows=c(5:104),skipEmptyCols=F) ;
names(LassDiff.1)
names(LassDiff.1)<-c('Row','Size', 'nothing' ,sapply(strsplit(as.character(LassDiff.name[1,]),"/"),"[", 1))
names(LassDiff.1)
length(names(LassDiff.1))
names(LassDiff.1)[3:58]
names(LassDiff.1)[4:54]
strsplit(names(LassDiff.1)[4:54]," ")
sapply(strsplit(names(LassDiff.1)[4:54]," "), "[",1)
sapply(strsplit(names(LassDiff.1)[4:54]," "), "[",2)
LassDiff.names1<-sapply(strsplit(names(LassDiff.1)[4:54]," "), "[",2)
strsplit(LassDiff.names1,"-5")
sapply(strsplit(LassDiff.names1,"-5"),"[",1)
LassDiff.names2<-sapply(strsplit(LassDiff.names1,"-5"),"[",1) ;
names(LaserDS.data)
names(LaserDS.data)[-1]
match(names(LaserDS.data)[-1],LassDiff.names2 )
match(names(LassDiff.names2, LaserDS.data)[-1])
match(LassDiff.names2,names(LaserDS.data)[-1])
match(names(LaserDS.data)[-1],LassDiff.names2)
LassDiff.names2 %in% names(LaserDS.data)[-1]
!LassDiff.names2 %in% names(LaserDS.data)[-1]
!(LassDiff.names2 %in% names(LaserDS.data)[-1])
LassDiff.names2[!(LassDiff.names2 %in% names(LaserDS.data)[-1])]
LassDiff.names2
names(LaserDS.data)[-1]
names(LaserDS.data)[!(names(LaserDS.data)[-1] %in% LassDiff.names2)]
match(names(LaserDS.data)[!(names(LaserDS.data)[-1] %in% LassDiff.names2)], names(LaserDS.data))
LassDiff.names2
LassDiff.name
grep("SRS",LassDiff.name)
LassDiff.name[19]
LassDiff.name[19]<-"SRS-1508-5/4/2018 12:25:11 PM" ;
LassDiff.names1<-sapply(strsplit(names(LassDiff.1)[4:54]," "), "[",2) ;
LassDiff.names2<-sapply(strsplit(LassDiff.names1,"-5"),"[",1) ;
match(names(LaserDS.data)[-1],LassDiff.names2)
match(LassDiff.names2,names(LaserDS.data)[-1])
names(LaserDS.data)[!(names(LaserDS.data)[-1] %in% LassDiff.names2)]
match(names(LaserDS.data)[!(names(LaserDS.data)[-1] %in% LassDiff.names2)], names(LaserDS.data))
LassDiff.name<-read.xlsx("C:/Felipe/LaserDifractionSoilTextureAnalysis/Manuscript/USDA Standards_PSA_Mastersizer_Felipe_20180824.xlsx", sheet="correct (6) fraction",startRow=2, colNames=F, rows=c(2)) ;
grep("SRS",LassDiff.name)
LassDiff.name[19]
LassDiff.name[19]<-"SRS-1508-5/4/2018 12:25:11 PM" ;
grep("SRS",LassDiff.name)
LassDiff.name[19]
LassDiff.name[1,]
c('Row','Size', 'nothing' ,sapply(strsplit(as.character(LassDiff.name[1,]),"/"),"[", 1))
LassDiff.names1<-sapply(strsplit(names(LassDiff.1)[4:54]," "), "[",2) ;
LassDiff.names1
LassDiff.names2<-sapply(strsplit(LassDiff.names1,"-5"),"[",1) ;
LassDiff.names2
match(names(LaserDS.data)[-1],LassDiff.names2)
match(LassDiff.names2,names(LaserDS.data)[-1])
names(LaserDS.data)[!(names(LaserDS.data)[-1] %in% LassDiff.names2)]
names(LaserDS.data)
##############################################################################################################
#
#
# Program to verify the data from the table that it is going to be published as part of the Laser diffraction paper
#
# Felipe Montes 2019  05 07
#
#
#
#
###############################################################################################################
###############################################################################################################
#                          Loading Packages and setting up working directory
###############################################################################################################
#  Tell the program where the package libraries are  #####################
.libPaths("C:/Felipe/SotwareANDCoding/R_Library/library")  ;
#  Set Working directory
setwd("C:\\Felipe\\LaserDifractionSoilTextureAnalysis\\Manuscript") ;
#Loand And install packages
#install.packages('tibble', dependencies = T)
#install.packages('readxl', dependencies = T)
library(readxl) ;
library(XLConnect) ;
library(openxlsx) ;
###############################################################################################################
#                         Read data sets into R
###############################################################################################################
LaserDS.data<-read.xlsx("./Review/Second Review/Laser and Std Results for SSSAJ.xlsx", sheet="Laser Diffraction-Sieving Data", colNames=T) ;
names(LaserDS.data)
############################################## REad the names of the samples from the spreadsheet ######################################
LassDiff.name<-read.xlsx("C:/Felipe/LaserDifractionSoilTextureAnalysis/Manuscript/USDA Standards_PSA_Mastersizer_Felipe_20180824.xlsx", sheet="correct (6) fraction",startRow=2, colNames=F, rows=c(2)) ;
grep("SRS",LassDiff.name)
LassDiff.name[19]
LassDiff.name[18]
names(LassDiff.1)<-c('Row','Size', 'nothing' ,sapply(strsplit(as.character(LassDiff.name[1,]),"/"),"[", 1))
names(LassDiff.1)
LassDiff.1<-read.xlsx("C:/Felipe/LaserDifractionSoilTextureAnalysis/Manuscript/USDA Standards_PSA_Mastersizer_Felipe_20180824.xlsx", sheet="correct (6) fraction",startRow=5, colNames=F, rows=c(5:104),skipEmptyCols=F) ;
tail(LassDiff.1)
str(LassDiff.1)
names(LassDiff.1)<-c('Row','Size', 'nothing' ,sapply(strsplit(as.character(LassDiff.name[1,]),"/"),"[", 1))
names(LassDiff.1)
LassDiff.names1<-sapply(strsplit(names(LassDiff.1)[4:54]," "), "[",2) ;
LassDiff.names1
LassDiff.names2<-sapply(strsplit(LassDiff.names1,"-5"),"[",1) ;
LassDiff.names2
match(names(LaserDS.data)[-1],LassDiff.names2)
match(LassDiff.names2,names(LaserDS.data)[-1])
names(LaserDS.data)[!(names(LaserDS.data)[-1] %in% LassDiff.names2)]
LassDiff.names2
LassDiff.names2[18]
names(LaserDS.data)[-1]
names(LaserDS.data)[19]
names(LaserDS.data)[20]
LassDiff.names2[18]==names(LaserDS.data)[20]
names(LaserDS.data)[!(names(LaserDS.data)[-1] %in% LassDiff.names2)]
match(names(LaserDS.data)[!(names(LaserDS.data)[-1] %in% LassDiff.names2)], names(LaserDS.data))
names(LaserDS.data) %in% LassDiff.names2
names(LaserDS.data)[31]
names(LaserDS.data)[21]
str(names(LaserDS.data))
str(LassDiff.names2)
names(LaserDS.data)[21,31,43,46]
names(LaserDS.data)[c(21,31,43,46)]
names(LaserDS.data)[c(1,21,31,43,46)]
LassDiff.names2 %in% names(LaserDS.data)
names(LaserDS.data) %in% LassDiff.names2
LassDiff.names2 %in% names(LaserDS.data)
names(LaserDS.data)[c(1,21,31,43,46)]
LassDiff.names2
##############################################################################################################
#
#
# Program to verify the data from the table that it is going to be published as part of the Laser diffraction paper
#
# Felipe Montes 2019  05 07
#
#
#
#
###############################################################################################################
###############################################################################################################
#                          Loading Packages and setting up working directory
###############################################################################################################
#  Tell the program where the package libraries are  #####################
.libPaths("C:/Felipe/SotwareANDCoding/R_Library/library")  ;
#  Set Working directory
setwd("C:\\Felipe\\LaserDifractionSoilTextureAnalysis\\Manuscript") ;
#Loand And install packages
#install.packages('tibble', dependencies = T)
#install.packages('readxl', dependencies = T)
library(readxl) ;
library(XLConnect) ;
library(openxlsx) ;
###############################################################################################################
#                         Read data sets into R
###############################################################################################################
LaserDS.data<-read.xlsx("./Review/Second Review/Laser and Std Results for SSSAJ.xlsx", sheet="Laser Diffraction-Sieving Data", colNames=T) ;
names(LaserDS.data)
############################################## REad the names of the samples from the spreadsheet ######################################
LassDiff.name<-read.xlsx("C:/Felipe/LaserDifractionSoilTextureAnalysis/Manuscript/USDA Standards_PSA_Mastersizer_Felipe_20180824.xlsx", sheet="correct (6) fraction",startRow=2, colNames=F, rows=c(2)) ;
LassDiff.name
str(LassDiff.name)
sapply(strsplit(as.character(LassDiff.name[1,]),"/"),"[", 1)
LassDiff.1<-read.xlsx("C:/Felipe/LaserDifractionSoilTextureAnalysis/Manuscript/USDA Standards_PSA_Mastersizer_Felipe_20180824.xlsx", sheet="correct (6) fraction",startRow=5, colNames=F, rows=c(5:104),skipEmptyCols=F) ;
tail(LassDiff.1)
str(LassDiff.1)
names(LassDiff.1)<-c('Row','Size', 'nothing' ,sapply(strsplit(as.character(LassDiff.name[1,]),"/"),"[", 1))
names(LassDiff.1)
names(LassDiff.1)[4:54]
sapply(strsplit(names(LassDiff.1)[4:54]," "), "[",2)
sapply(strsplit(LassDiff.names1,"-5"),"[",1)
LassDiff.names1<-sapply(strsplit(names(LassDiff.1)[4:54]," "), "[",2) ;
sapply(strsplit(LassDiff.names1,"-5"),"[",1)
names(LaserDS.data) %in% LassDiff.names2
LassDiff.names2<-sapply(strsplit(LassDiff.names1,"-5"),"[",1) ;
names(LaserDS.data) %in% LassDiff.names2
LassDiff.names2 %in% names(LaserDS.data)
str(names(LaserDS.data))
str(LassDiff.names2)
names(LaserDS.data)[c(1,21,31,43,46)]
##############################################################################################################
#
#
# Program to Extract soil Texture data from the NAPT pdf document data base and plot texture plots from them.
#
# Felipe Montes 2018
#
# Uses the  package 'soiltexture' to plot the texture
# Also uses the package 'XLConnect' to read and write information from excel spreadsheets with soil samples information
#
#
###############################################################################################################
#  Tell the program where the package libraries are  #####################
.libPaths("C:/Felipe/SotwareANDCoding/R_Library/library")  ;
###### Introduction to Web Scraping #####
# Preliminaries
rm(list = ls())
# Set your working directory to some place you can find
setwd("C:/Felipe/LaserDifractionSoilTextureAnalysis/NAPTSoilsData") ;
# First we will need to install the packages we plan to use for this exercise (
# if they are not already installed on your computer).
# install.packages("httr", dependencies = TRUE)
# install.packages("stringr", dependencies = TRUE)
# install.packages("soiltexture")
# httr is a package for downloading html
library(httr)
# A package for manipulating strings
library(stringr)
library(XML)
#install.packages('rvest')
#install.packages("magrittr")
library(rvest)
library(magrittr)
# Package for soil texture plotting
library('soiltexture')
# Package for writing and reading excel files
library(XLConnect) ;
########################################################################################################
#
#                      Get the NAPT soil texture data and format it for plotting
#
#########################################################################################################
NAPT.data<-readWorksheetFromFile("Results_data_all.xlsx", sheet="Combined", startRow=1, endRow=864) ;
str(NAPT.data)
head(NAPT.data)
NAPT.data.head<-NAPT.data[c(1,2),] ;
NAPT.data.nohead<-NAPT.data[-c(1,2),] ;
head(NAPT.data.nohead)
NAPT.data.head
NAPT.data.nohead
View(NAPT.data.nohead)
View(NAPT.data.nohead)
match(names(LaserDS.data)[-1],LassDiff.names2)
##############################################################################################################
#
#
# Program to verify the data from the table that it is going to be published as part of the Laser diffraction paper
#
# Felipe Montes 2019  05 07
#
#
#
#
###############################################################################################################
###############################################################################################################
#                          Loading Packages and setting up working directory
###############################################################################################################
#  Tell the program where the package libraries are  #####################
.libPaths("C:/Felipe/SotwareANDCoding/R_Library/library")  ;
#  Set Working directory
setwd("C:\\Felipe\\LaserDifractionSoilTextureAnalysis\\Manuscript") ;
#Loand And install packages
#install.packages('tibble', dependencies = T)
#install.packages('readxl', dependencies = T)
library(readxl) ;
library(XLConnect) ;
library(openxlsx) ;
###############################################################################################################
#                         Read data sets into R
###############################################################################################################
LaserDS.data<-read.xlsx("./Review/Second Review/Laser and Std Results for SSSAJ.xlsx", sheet="Laser Diffraction-Sieving Data", colNames=T) ;
names(LaserDS.data)
############################################## REad the names of the samples from the spreadsheet ######################################
LassDiff.name<-read.xlsx("C:/Felipe/LaserDifractionSoilTextureAnalysis/Manuscript/USDA Standards_PSA_Mastersizer_Felipe_20180824.xlsx", sheet="correct (6) fraction",startRow=2, colNames=F, rows=c(2)) ;
#grep("SRS",LassDiff.name)
############################################# Read the LD data from the spreadsheet  ########################################################
LassDiff.1<-read.xlsx("C:/Felipe/LaserDifractionSoilTextureAnalysis/Manuscript/USDA Standards_PSA_Mastersizer_Felipe_20180824.xlsx", sheet="correct (6) fraction",startRow=5, colNames=F, rows=c(5:104),skipEmptyCols=F) ;
tail(LassDiff.1)
str(LassDiff.1)
names(LassDiff.1)<-c('Row','Size', 'nothing' ,sapply(strsplit(as.character(LassDiff.name[1,]),"/"),"[", 1))
#####################################################  Organizing column names to compare them withw the spreadsheet names ##################
LassDiff.names1<-sapply(strsplit(names(LassDiff.1)[4:54]," "), "[",2) ;
LassDiff.names2<-sapply(strsplit(LassDiff.names1,"-5"),"[",1) ;
names(LaserDS.data) %in% LassDiff.names2
LassDiff.names2 %in% names(LaserDS.data)
str(names(LaserDS.data))
str(LassDiff.names2)
names(LaserDS.data)[c(1,21,31,43,46)]
match(names(LaserDS.data)[-1],LassDiff.names2)
match(LassDiff.names2,names(LaserDS.data)[-1])
names(LaserDS.data)[!(names(LaserDS.data)[-1] %in% LassDiff.names2)]
names(LaserDS.data)[!(names(LaserDS.data) %in% LassDiff.names2)]
match(names(LaserDS.data)[!(names(LaserDS.data) %in% LassDiff.names2)], names(LaserDS.data))
load(file='NAPTTexturePlot.RData');
##############################################################################################################
#
#
# Program to Plot table 1 inthe laser diffraction paper, with all the information requested by the reviewwers
#
# Felipe Montes 2018  12 13
#
###############################################################################################################
#  Tell the program where the package libraries are  #####################
.libPaths("C:/Felipe/SotwareANDCoding/R_Library/library")  ;
# Preliminaries
rm(list = ls())
# Set your working directory to some place you can find
setwd("C:/Felipe/LaserDifractionSoilTextureAnalysis/NAPTSoilsData") ;
# Load the data from (file='NAPTTexturePlot.RData') obtained from runing the NAPTTexturePlot.R
# Package for writing and reading excel files
library(XLConnect) ;
library(stringr) ;
load(file='NAPTTexturePlot.RData');
Table1.data<-readWorksheetFromFile("C:\\Felipe\\LaserDifractionSoilTextureAnalysis\\Manuscript\\Table120180927.xlsx", sheet="New",startCol= 1, endCol=6) ;
head(Table1.data)
head(Paper.Samples)
Table1Papersamples<-merge(Table1.data, Paper.Samples, by.x='Sample',by.y='SAMPLE', all.x=T) ;
View(Table1Papersamples)
View(Table1Papersamples)
View(Table1Papersamples)
View(Table1Papersamples)
