str(SCC.t)
SCC.t<-data.frame(as.numeric(t(SoilCarbonCarbonates[,5:16]), stringsAsFactors = F)) ;
str(SCC.t)
SCC.t<-data.frame(as.numeric(t(SoilCarbonCarbonates[,7:16]), stringsAsFactors = F)) ;
str(SCC.t)
SCC.t<-data.frame(t(SoilCarbonCarbonates[,7:16]), stringsAsFactors = F);
str(SCC.t)
SCC.t
SCC.Data<-data.frame(SCC.t[,1])
SCC.Data
#  Tell the program where the package libraries are  #####################
.libPaths("C:/Felipe/SotwareANDCoding/R_Library/library")  ;
###### Introduction to Web Scraping #####
# Preliminaries
rm(list = ls())
# Set your working directory to some place you can find
setwd("C:/Felipe/LaserDifractionSoilTextureAnalysis/NAPTSoilsData") ;
# First we will need to install the packages we plan to use for this exercise (
# if they are not already installed on your computer).
# install.packages("httr", dependencies = TRUE)
# install.packages("stringr", dependencies = TRUE)
# httr is a package for downloading html
library(httr)
# A package for manipulating strings
library(stringr)
library(XML)
#install.packages('rvest')
#install.packages("magrittr")
library(rvest)
library(magrittr)
#install.packages("soiltexture")
library('soiltexture')
library(XLConnect) ;
SoilCarbonCarbonates<-readWorksheetFromFile("Results_data_all.xlsx", sheet="Carbon and carbonates", header=T) ;
head(SoilCarbonCarbonates)
str(SoilCarbonCarbonates)
SCC.t<-data.frame(t(SoilCarbonCarbonates[,7:16]), stringsAsFactors = F);
str(SCC.t)
c("Units", "n",rep(seq(SoilCarbonCarbonates[1,2],SoilCarbonCarbonates[1,3]),each=2))
SCC.Data<-data.frame(SCC.t[,1])
SCC.t[,1]
head(SoilCarbonCarbonates)
SCC.Data<-data.frame(SCC.t[,1], rep(seq(SoilCarbonCarbonates[1,2],SoilCarbonCarbonates[1,3]),each=2))  ;
SCC.Data
rep(c('Median', 'MAD'),4)
SCC.Data<-data.frame(SCC.t[,1], rep(seq(SoilCarbonCarbonates[1,2],SoilCarbonCarbonates[1,3]),each=2), rep(c('Median', 'MAD'),4) ) ;
SCC.Data<-data.frame(SCC.t[,1], rep(seq(SoilCarbonCarbonates[1,2],SoilCarbonCarbonates[1,3]),each=2), rep(c('Median', 'MAD'),5) ) ;
SCC.Data
SCC.Data<-data.frame(SCC.t[,1], rep(seq(SoilCarbonCarbonates[1,2],SoilCarbonCarbonates[1,3]),each=2), rep(c('Median', 'MAD'),5),SoilCarbonCarbonates[1,4] ) ;
SCC.Data
SCC.Data<-data.frame(SoilCarbonCarbonates[1,1], rep(seq(SoilCarbonCarbonates[1,2],SoilCarbonCarbonates[1,3]),each=2), SoilCarbonCarbonates[1,4], rep(c('Median', 'MAD'),5),SCC.t[,1] ) ;
names(SCC.Data)<-c('YEAR' , 'SAMPLE' , 'ANALYSIS' ,'TYPE' , 'VALUE');
head(SCC.Data)
head(SoilCarbonCarbonates)
t(SoilCarbonCarbonates[,6])
str(SoilCarbonCarbonates)
SCC.Data<-data.frame(SoilCarbonCarbonates[1,1], rep(seq(SoilCarbonCarbonates[1,2],SoilCarbonCarbonates[1,3]),each=2), SoilCarbonCarbonates[1,4], rep(c('Median', 'MAD'),5),SCC.t[,1] , SoilCarbonCarbonates[1,6] ) ;
names(SCC.Data)<-c('YEAR' , 'SAMPLE' , 'ANALYSIS' ,'TYPE' , 'VALUE' , 'n');
head(SCC.Data)
SCC.Data<-data.frame(SoilCarbonCarbonates[1,1], rep(seq(SoilCarbonCarbonates[1,2],SoilCarbonCarbonates[1,3]),each=2), SoilCarbonCarbonates[1,4], rep(c('Median', 'MAD'),5),SCC.t[,1] , SoilCarbonCarbonates[1,6] ) ;
SCC.Data
names(SCC.Data)<-c('YEAR' , 'SAMPLE' , 'ANALYSIS' ,'TYPE' , 'VALUE' , 'n');
head(SCC.Data)
SCC.Data
SCC.Data.0<-SCC.Data
rm(SCC.Data)
t(SoilCarbonCarbonates[,7:16])[,1]
SCC.t[,1]
SCC.Data<-data.frame(SoilCarbonCarbonates[1,1], rep(seq(SoilCarbonCarbonates[1,2],SoilCarbonCarbonates[1,3]),each=2), SoilCarbonCarbonates[1,4], rep(c('Median', 'MAD'),5),t(SoilCarbonCarbonates[,7:16])[,1] , SoilCarbonCarbonates[1,6] ) ;
names(SCC.Data)<-c('YEAR' , 'SAMPLE' , 'ANALYSIS' ,'TYPE' , 'VALUE' , 'n');
SCC.Data
SCC.Data.0
rep(seq(SoilCarbonCarbonates[2,2],SoilCarbonCarbonates[2,3]),each=2)
SCC.Data<-data.frame(SoilCarbonCarbonates[1,1], rep(seq(SoilCarbonCarbonates[1,2],SoilCarbonCarbonates[1,3]),each=2), SoilCarbonCarbonates[1,17], rep(c('Median', 'MAD'),5),t(SoilCarbonCarbonates[,20:29])[,1] , SoilCarbonCarbonates[1,19] ) ;
names(SCC.Data)<-c('YEAR' , 'SAMPLE' , 'ANALYSIS' ,'TYPE' , 'VALUE' , 'n');
head(SCC.Data)
SCC.Data
rbind(SCC.Data.0,SCC.Data)
SCC.Data.0<-SCC.Data.1
rm(SCC.Data)
SCC.Data.1<-rbind(SCC.Data.0,SCC.Data)
SCC.Data<-data.frame(SoilCarbonCarbonates[1,1], rep(seq(SoilCarbonCarbonates[1,2],SoilCarbonCarbonates[1,3]),each=2), SoilCarbonCarbonates[1,17], rep(c('Median', 'MAD'),5),t(SoilCarbonCarbonates[,20:29])[,1] , SoilCarbonCarbonates[1,19] ) ;
names(SCC.Data)<-c('YEAR' , 'SAMPLE' , 'ANALYSIS' ,'TYPE' , 'VALUE' , 'n');
SCC.Data
SCC.Data.1<-rbind(SCC.Data.0,SCC.Data)
SCC.Data.0<-SCC.Data.1
rm(SCC.Data)
SCC.Data.0
rm(SCC.Data)
rm(SCC.Data,SCC.Data.1)
SCC.Data<-data.frame(SoilCarbonCarbonates[1,1], rep(seq(SoilCarbonCarbonates[1,2],SoilCarbonCarbonates[1,3]),each=2), SoilCarbonCarbonates[1,30], rep(c('Median', 'MAD'),5),t(SoilCarbonCarbonates[,33:42])[,1] , SoilCarbonCarbonates[1,32] ) ;
names(SCC.Data)<-c('YEAR' , 'SAMPLE' , 'ANALYSIS' ,'TYPE' , 'VALUE' , 'n');
SCC.Data
SCC.Data.1<-rbind(SCC.Data.0,SCC.Data)
SCC.Data.0<-SCC.Data.1
rm(SCC.Data,SCC.Data.1)
SCC.Data<-data.frame(SoilCarbonCarbonates[1,1], rep(seq(SoilCarbonCarbonates[1,2],SoilCarbonCarbonates[1,3]),each=2), SoilCarbonCarbonates[1,4], rep(c('Median', 'MAD'),5),t(SoilCarbonCarbonates[,7:16])[,1] , SoilCarbonCarbonates[1,6] ) ;
names(SCC.Data)<-c('YEAR' , 'SAMPLE' , 'ANALYSIS' ,'TYPE' , 'VALUE' , 'n');
SCC.Data
SCC.Data<-data.frame(SoilCarbonCarbonates[1,1], rep(seq(SoilCarbonCarbonates[1,2],SoilCarbonCarbonates[1,3]),each=2), SoilCarbonCarbonates[1,4], rep(c('Median', 'MAD'),5),t(SoilCarbonCarbonates[,7:16])[,1] , SoilCarbonCarbonates[1,6] ) ;
names(SCC.Data)<-c('YEAR' , 'SAMPLE' , 'ANALYSIS' ,'TYPE' , 'VALUE' , 'n');
SCC.Data.1<-SCC.Data;
SCC.Data.1
seq(2,5)
i
i=2
i
(3+(13*i))
(4+(13*(i-1)))
seq(7+((i-1)*13),7+9+((i-1)*13))
SoilCarbonCarbonates[,seq(7+((i-1)*13),7+9+((i-1)*13))]
t(SoilCarbonCarbonates[,seq(7+((i-1)*13),7+9+((i-1)*13))])
t(SoilCarbonCarbonates[,seq(7+((i-1)*13),7+9+((i-1)*13))])[,1]
SoilCarbonCarbonates[1,6+((i-1)*13)]
for ( i in seq(2,5) ) {
SCC.Data<-data.frame(SoilCarbonCarbonates[1,1], rep(seq(SoilCarbonCarbonates[1,2],SoilCarbonCarbonates[1,3]),each=2), SoilCarbonCarbonates[1,(4+(13*(i-1)))], rep(c('Median', 'MAD'),5),t(SoilCarbonCarbonates[,seq(7+((i-1)*13),7+9+((i-1)*13))])[,1] , SoilCarbonCarbonates[1,6+((i-1)*13)] ) ;
names(SCC.Data)<-c('YEAR' , 'SAMPLE' , 'ANALYSIS' ,'TYPE' , 'VALUE' , 'n');
SCC.Data
SCC.Data.1<-rbind(SCC.Data.0,SCC.Data)
SCC.Data.0<-SCC.Data.1
rm(SCC.Data,SCC.Data.1)
}
SCC.Data.1
SCC.Data.0
seq(2,12)
t(SoilCarbonCarbonates[,seq(7+((i-1)*13),7+9+((i-1)*13))])
i
i=2
t(SoilCarbonCarbonates[,seq(7+((i-1)*13),7+9+((i-1)*13))])
SCC.Data<-data.frame(SoilCarbonCarbonates[1,1], rep(seq(SoilCarbonCarbonates[1,2],SoilCarbonCarbonates[1,3]),each=2), SoilCarbonCarbonates[1,4], rep(c('Median', 'MAD'),5),t(SoilCarbonCarbonates[,7:16])[,1] , SoilCarbonCarbonates[1,6] ) ;
names(SCC.Data)<-c('YEAR' , 'SAMPLE' , 'ANALYSIS' ,'TYPE' , 'VALUE' , 'n');
SCC.Data.1<-SCC.Data;
SCC.Data.0<-SCC.Data;
for (j in seq(2,12))  {
for ( i in seq(2,5) ) {
SCC.Data<-data.frame(SoilCarbonCarbonates[j,1], rep(seq(SoilCarbonCarbonates[j,2],SoilCarbonCarbonates[j,3]),each=2), SoilCarbonCarbonates[j,(4+(13*(i-1)))], rep(c('Median', 'MAD'),5),t(SoilCarbonCarbonates[,seq(7+((i-1)*13),7+9+((i-1)*13))])[,1] , SoilCarbonCarbonates[j,6+((i-1)*13)] ) ;
names(SCC.Data)<-c('YEAR' , 'SAMPLE' , 'ANALYSIS' ,'TYPE' , 'VALUE' , 'n');
SCC.Data
SCC.Data.1<-rbind(SCC.Data.0,SCC.Data)
SCC.Data.0<-SCC.Data.1
rm(SCC.Data,SCC.Data.1)
}
}
SCC.Data.0
writeWorksheetToFile("Results_data_all.xlsx",SCC.Data.0, sheet="Carbon and Carbonates table") ;
writeWorksheetToFile("Results_data_all.xlsx",SCC.Data.0, sheet="Carbon and Carbonates table") ;
#  Tell the program where the package libraries are  #####################
.libPaths("C:/Felipe/SotwareANDCoding/R_Library/library")  ;
###### Introduction to Web Scraping #####
# Preliminaries
rm(list = ls())
# Set your working directory to some place you can find
setwd("C:/Felipe/LaserDifractionSoilTextureAnalysis/NAPTSoilsData") ;
library(httr)
# A package for manipulating strings
library(stringr)
library(XML)
#install.packages('rvest')
#install.packages("magrittr")
library(rvest)
library(magrittr)
library(XLConnect) ;
SoilCarbonCarbonates<-readWorksheetFromFile("Results_data_all.xlsx", sheet="Carbon and carbonates", header=T) ;
head(SoilCarbonCarbonates)
SoilCarbonCarbonates[1,1]
SoilCarbonCarbonates[1,2]
SoilCarbonCarbonates[1,3]
rep(seq(SoilCarbonCarbonates[1,2],SoilCarbonCarbonates[1,3]),each=2)
SoilCarbonCarbonates[1,4]
rep(seq(SoilCarbonCarbonates[1,2],SoilCarbonCarbonates[1,3]),each=2), SoilCarbonCarbonates[1,4]
seq(SoilCarbonCarbonates[1,2],SoilCarbonCarbonates[1,3])
j=1
j=2
i=1
(SoilCarbonCarbonates[j,1]
SoilCarbonCarbonates[j,1]
seq(SoilCarbonCarbonates[j,2],SoilCarbonCarbonates[j,3])
rep(seq(SoilCarbonCarbonates[1,2],SoilCarbonCarbonates[1,3]),each=2)
rep(seq(SoilCarbonCarbonates[1,2],SoilCarbonCarbonates[1,3]),each=2)
seq(SoilCarbonCarbonates[1,2],SoilCarbonCarbonates[1,3])
seq(SoilCarbonCarbonates[j,2],SoilCarbonCarbonates[j,3])
rep(seq(SoilCarbonCarbonates[j,2],SoilCarbonCarbonates[j,3]),each=2)
SoilCarbonCarbonates[j,(4+(13*(i-1)))]
i=2
SoilCarbonCarbonates[j,(4+(13*(i-1)))]
rep(c('Median', 'MAD')
rep(c('Median', 'MAD'),5)
t(SoilCarbonCarbonates[,seq(7+((i-1)*13),7+9+((i-1)*13))])[,1]
SoilCarbonCarbonates[j,6+((i-1)*13)]
j=2
i=1
SCC.Data<-data.frame(SoilCarbonCarbonates[j,1], rep(seq(SoilCarbonCarbonates[j,2],SoilCarbonCarbonates[j,3]),each=2), SoilCarbonCarbonates[j,(4+(13*(i-1)))], rep(c('Median', 'MAD'),5),t(SoilCarbonCarbonates[,seq(7+((i-1)*13),7+9+((i-1)*13))])[,1] , SoilCarbonCarbonates[j,6+((i-1)*13)] ) ;
SCC.Data
names(SCC.Data)<-c('YEAR' , 'SAMPLE' , 'ANALYSIS' ,'TYPE' , 'VALUE' , 'n');
SCC.Data
SCC.Data.1<-rbind(SCC.Data.0,SCC.Data)
SCC.Data.0<-SCC.Data.1
rm(SCC.Data,SCC.Data.1)
j=2
i=1
t(SoilCarbonCarbonates[,seq(7+((i-1)*13),7+9+((i-1)*13))])
t(SoilCarbonCarbonates[,seq(7+((i-1)*13),7+9+((i-1)*13))])[,2]
SCC.Data<-data.frame(SoilCarbonCarbonates[j,1], rep(seq(SoilCarbonCarbonates[j,2],SoilCarbonCarbonates[j,3]),each=2), SoilCarbonCarbonates[j,(4+(13*(i-1)))], rep(c('Median', 'MAD'),5),t(SoilCarbonCarbonates[,seq(7+((i-1)*13),7+9+((i-1)*13))])[,2] , SoilCarbonCarbonates[j,6+((i-1)*13)] ) ;
names(SCC.Data)<-c('YEAR' , 'SAMPLE' , 'ANALYSIS' ,'TYPE' , 'VALUE' , 'n');
SCC.Data
SCC.Data.0<-SCC.Data;
SCC.Data.1<-rbind(SCC.Data.0,SCC.Data)
rm(SCC.Data,SCC.Data.1)
SCC.Data.0
SCC.Data.1<-rbind(SCC.Data.0,SCC.Data)
SCC.Data<-data.frame(SoilCarbonCarbonates[j,1], rep(seq(SoilCarbonCarbonates[j,2],SoilCarbonCarbonates[j,3]),each=2), SoilCarbonCarbonates[j,(4+(13*(i-1)))], rep(c('Median', 'MAD'),5),t(SoilCarbonCarbonates[,seq(7+((i-1)*13),7+9+((i-1)*13))])[,2] , SoilCarbonCarbonates[j,6+((i-1)*13)] ) ;
names(SCC.Data)<-c('YEAR' , 'SAMPLE' , 'ANALYSIS' ,'TYPE' , 'VALUE' , 'n');
SCC.Data
SCC.Data.1<-rbind(SCC.Data.0,SCC.Data)
SCC.Data.1
SCC.Data.0<-SCC.Data.1
rm(SCC.Data,SCC.Data.1)
rm(SCC.Data,SCC.Data.1)
SCC.Data<-data.frame(SoilCarbonCarbonates[j,1], rep(seq(SoilCarbonCarbonates[j,2],SoilCarbonCarbonates[j,3]),each=2), SoilCarbonCarbonates[j,(4+(13*(i-1)))], rep(c('Median', 'MAD'),5),t(SoilCarbonCarbonates[,seq(7+((i-1)*13),7+9+((i-1)*13))])[,2] , SoilCarbonCarbonates[j,6+((i-1)*13)] ) ;
names(SCC.Data)<-c('YEAR' , 'SAMPLE' , 'ANALYSIS' ,'TYPE' , 'VALUE' , 'n');
SCC.Data
SCC.Data.1<-rbind(SCC.Data.0,SCC.Data)
SCC.Data.1
rm(SCC.Data,SCC.Data.1)
SCC.Data
SCC.Data<-data.frame(SoilCarbonCarbonates[j,1], rep(seq(SoilCarbonCarbonates[j,2],SoilCarbonCarbonates[j,3]),each=2), SoilCarbonCarbonates[j,(4+(13*(i-1)))], rep(c('Median', 'MAD'),5),t(SoilCarbonCarbonates[,seq(7+((i-1)*13),7+9+((i-1)*13))])[,2] , SoilCarbonCarbonates[j,6+((i-1)*13)] ) ;
names(SCC.Data)<-c('YEAR' , 'SAMPLE' , 'ANALYSIS' ,'TYPE' , 'VALUE' , 'n');
SCC.Data
SCC.Data.1<-rbind(SCC.Data.0,SCC.Data)
SCC.Data.1
rm(SCC.Data,SCC.Data.1)
rm(SCC.Data.0,SCC.Data.1)
SCC.Data<-data.frame(SoilCarbonCarbonates[j,1], rep(seq(SoilCarbonCarbonates[j,2],SoilCarbonCarbonates[j,3]),each=2), SoilCarbonCarbonates[j,(4+(13*(i-1)))], rep(c('Median', 'MAD'),5),t(SoilCarbonCarbonates[,seq(7+((i-1)*13),7+9+((i-1)*13))])[,2] , SoilCarbonCarbonates[j,6+((i-1)*13)] ) ;
names(SCC.Data)<-c('YEAR' , 'SAMPLE' , 'ANALYSIS' ,'TYPE' , 'VALUE' , 'n');
SCC.Data
SCC.Data.1<-rbind(SCC.Data.0,SCC.Data)
SCC.Data.0<-SCC.Data.1
rm(SCC.Data,SCC.Data.1)
SCC.Data<-data.frame(SoilCarbonCarbonates[j,1], rep(seq(SoilCarbonCarbonates[j,2],SoilCarbonCarbonates[j,3]),each=2), SoilCarbonCarbonates[j,(4+(13*(i-1)))], rep(c('Median', 'MAD'),5),t(SoilCarbonCarbonates[,seq(7+((i-1)*13),7+9+((i-1)*13))])[,2] , SoilCarbonCarbonates[j,6+((i-1)*13)] ) ;
names(SCC.Data)<-c('YEAR' , 'SAMPLE' , 'ANALYSIS' ,'TYPE' , 'VALUE' , 'n');
SCC.Data
SCC.Data.1<-rbind(SCC.Data.0,SCC.Data)
SCC.Data.0<-SCC.Data.1
rm(SCC.Data,SCC.Data.1)
SCC.Data<-data.frame(SoilCarbonCarbonates[j,1], rep(seq(SoilCarbonCarbonates[j,2],SoilCarbonCarbonates[j,3]),each=2), SoilCarbonCarbonates[j,(4+(13*(i-1)))], rep(c('Median', 'MAD'),5),t(SoilCarbonCarbonates[,seq(7+((i-1)*13),7+9+((i-1)*13))])[,2] , SoilCarbonCarbonates[j,6+((i-1)*13)] ) ;
names(SCC.Data)<-c('YEAR' , 'SAMPLE' , 'ANALYSIS' ,'TYPE' , 'VALUE' , 'n');
SCC.Data
SCC.Data.0<-SCC.Data
SCC.Data.0
for (j in seq(2,12))  {
for ( i in seq(2,5) ) {
SCC.Data<-data.frame(SoilCarbonCarbonates[j,1], rep(seq(SoilCarbonCarbonates[j,2],SoilCarbonCarbonates[j,3]),each=2), SoilCarbonCarbonates[j,(4+(13*(i-1)))], rep(c('Median', 'MAD'),5),t(SoilCarbonCarbonates[,seq(7+((i-1)*13),7+9+((i-1)*13))])[,2] , SoilCarbonCarbonates[j,6+((i-1)*13)] ) ;
names(SCC.Data)<-c('YEAR' , 'SAMPLE' , 'ANALYSIS' ,'TYPE' , 'VALUE' , 'n');
SCC.Data
SCC.Data.1<-rbind(SCC.Data.0,SCC.Data)
SCC.Data.0<-SCC.Data.1
rm(SCC.Data,SCC.Data.1)
}
}
writeWorksheetToFile("Results_data_all.xlsx",SCC.Data.0, sheet="Carbon and Carbonates table") ;
writeWorksheetToFile("Results_data_all.xlsx",SCC.Data.0, sheet="Carbon and Carbonates table") ;
SoilCarbonCarbonates<-readWorksheetFromFile("Results_data_all.xlsx", sheet="Carbon and carbonates", header=T) ;
head(SoilCarbonCarbonates)
str(SoilCarbonCarbonates)
for (j in seq(2,12))  {
for ( i in seq(2,5) ) {
SCC.Data<-data.frame(SoilCarbonCarbonates[j,1], rep(seq(SoilCarbonCarbonates[j,2],SoilCarbonCarbonates[j,3]),each=2), SoilCarbonCarbonates[j,(4+(13*(i-1)))], rep(c('Median', 'MAD'),5),t(SoilCarbonCarbonates[,seq(7+((i-1)*13),7+9+((i-1)*13))])[,2] , SoilCarbonCarbonates[j,6+((i-1)*13)] ) ;
names(SCC.Data)<-c('YEAR' , 'SAMPLE' , 'ANALYSIS' ,'TYPE' , 'VALUE' , 'n');
SCC.Data
SCC.Data.1<-rbind(SCC.Data.0,SCC.Data)
SCC.Data.0<-SCC.Data.1
rm(SCC.Data,SCC.Data.1)
}
}
writeWorksheetToFile("Results_data_all.xlsx",SCC.Data.0, sheet="Carbon and Carbonates table") ;
writeWorksheetToFile("Results_data_all.xlsx",SCC.Data.0, sheet="Carbon and Carbonates table") ;
j=2
i=1
SoilCarbonCarbonates[j,1]
rep(seq(SoilCarbonCarbonates[j,2],SoilCarbonCarbonates[j,3])
each=2)
seq(SoilCarbonCarbonates[j,2],SoilCarbonCarbonates[j,3])
rep(seq(SoilCarbonCarbonates[j,2],SoilCarbonCarbonates[j,3]),each=2)
SoilCarbonCarbonates[j,(4+(13*(i-1)))]
seq(7+((i-1)*13),7+9+((i-1)*13))])[,2] , SoilCarbonCarbonates[j,6+((i-1)*13)]
seq(7+((i-1)*13),7+9+((i-1)*13))])[,2] , SoilCarbonCarbonates[j,6+((i-1)*13)
7+((i-1)*13),7+9+((i-1)*13))])
7+((i-1)*13)
7+9+((i-1)*13))
7+9+((i-1)*13)
seq(7+((i-1)*13),7+9+((i-1)*13))
SoilCarbonCarbonates[,seq(7+((i-1)*13),7+9+((i-1)*13))])[,2] , SoilCarbonCarbonates[j,6+((i-1)*13
t(SoilCarbonCarbonates[,seq(7+((i-1)*13),7+9+((i-1)*13))])
t(SoilCarbonCarbonates[,seq(7+((i-1)*13),7+9+((i-1)*13))])[,2]
SoilCarbonCarbonates[j,6+((i-1)*13)]
SoilCarbonCarbonates
SCC.Data<-data.frame(SoilCarbonCarbonates[j,1], rep(seq(SoilCarbonCarbonates[j,2],SoilCarbonCarbonates[j,3]),each=2), SoilCarbonCarbonates[j,(4+(13*(i-1)))], rep(c('Median', 'MAD'),5),t(SoilCarbonCarbonates[,seq(7+((i-1)*13),7+9+((i-1)*13))])[,2] , SoilCarbonCarbonates[j,6+((i-1)*13)] )
SCC.Data
SCC.Data
names(SCC.Data)<-c('YEAR' , 'SAMPLE' , 'ANALYSIS' ,'TYPE' , 'VALUE' , 'n');
SCC.Data
for ( i in seq(2,5) ) {
SCC.Data<-data.frame(SoilCarbonCarbonates[j,1], rep(seq(SoilCarbonCarbonates[j,2],SoilCarbonCarbonates[j,3]),each=2), SoilCarbonCarbonates[j,(4+(13*(i-1)))], rep(c('Median', 'MAD'),5),t(SoilCarbonCarbonates[,seq(7+((i-1)*13),7+9+((i-1)*13))])[,2] , SoilCarbonCarbonates[j,6+((i-1)*13)] ) ;
names(SCC.Data)<-c('YEAR' , 'SAMPLE' , 'ANALYSIS' ,'TYPE' , 'VALUE' , 'n');
SCC.Data
SCC.Data.1<-rbind(SCC.Data.0,SCC.Data)
SCC.Data.0<-SCC.Data.1
rm(SCC.Data,SCC.Data.1)
}
SCC.Data
SCC.Data.0
for ( i in seq(1,5) ) {
SCC.Data<-data.frame(SoilCarbonCarbonates[j,1], rep(seq(SoilCarbonCarbonates[j,2],SoilCarbonCarbonates[j,3]),each=2), SoilCarbonCarbonates[j,(4+(13*(i-1)))], rep(c('Median', 'MAD'),5),t(SoilCarbonCarbonates[,seq(7+((i-1)*13),7+9+((i-1)*13))])[,2] , SoilCarbonCarbonates[j,6+((i-1)*13)] ) ;
names(SCC.Data)<-c('YEAR' , 'SAMPLE' , 'ANALYSIS' ,'TYPE' , 'VALUE' , 'n');
SCC.Data
SCC.Data.1<-rbind(SCC.Data.0,SCC.Data)
SCC.Data.0<-SCC.Data.1
rm(SCC.Data,SCC.Data.1)
}
SCC.Data.0
j
SoilCarbonCarbonates<-readWorksheetFromFile("Results_data_all.xlsx", sheet="Carbon and carbonates", header=T) ;
head(SoilCarbonCarbonates)
SoilCarbonCarbonates[,1:10]
SoilCarbonCarbonates<-readWorksheetFromFile("Results_data_all.xlsx", sheet="Carbon and carbonates", header=T, startRow=2) ;
SoilCarbonCarbonates[,1:10]
SoilCarbonCarbonates[,11:30]
SoilCarbonCarbonates[,11:20]
SoilCarbonCarbonates[,21:35]
SoilCarbonCarbonates[,36:50]
SoilCarbonCarbonates[,51:65]
SoilCarbonCarbonates[,51:68]
SoilCarbonCarbonates[,52:68]
SoilCarbonCarbonates[j,1]
########### Going  along the analysis direction (Horizontal)  First and then along the year (vertical) second  #########
j=1
i=1
SoilCarbonCarbonates[j,1]
seq(SoilCarbonCarbonates[j,2],SoilCarbonCarbonates[j,3])
rep(seq(SoilCarbonCarbonates[j,2],SoilCarbonCarbonates[j,3]),each=2)
SoilCarbonCarbonates[j,(4+(13*(i-1)))]
i=2
SoilCarbonCarbonates[j,(4+(13*(i-1)))]
i=3
SoilCarbonCarbonates[j,(4+(13*(i-1)))]
SoilCarbonCarbonates[j,(4+(13*(i-1)))]
i=4
SoilCarbonCarbonates[j,(4+(13*(i-1)))]
i=5
SoilCarbonCarbonates[j,(4+(13*(i-1)))]
i=1
rep(c('Median', 'MAD'),5)
7+((i-1)*13)
7+9+((i-1)*13)
seq(7+((i-1)*13),7+9+((i-1)*13))
i=2
seq(7+((i-1)*13),7+9+((i-1)*13))
i=3
seq(7+((i-1)*13),7+9+((i-1)*13))
i=4
seq(7+((i-1)*13),7+9+((i-1)*13))
i=5
seq(7+((i-1)*13),7+9+((i-1)*13))
SoilCarbonCarbonates[,seq(7+((i-1)*13),7+9+((i-1)*13))]
i=1
SoilCarbonCarbonates[,seq(7+((i-1)*13),7+9+((i-1)*13))]
t(SoilCarbonCarbonates[,seq(7+((i-1)*13),7+9+((i-1)*13))])
t(SoilCarbonCarbonates[,seq(7+((i-1)*13),7+9+((i-1)*13))])[,1]
SoilCarbonCarbonates[j,6+((i-1)*13)]
SCC.Data<-data.frame(SoilCarbonCarbonates[j,1], rep(seq(SoilCarbonCarbonates[j,2],SoilCarbonCarbonates[j,3]),each=2), SoilCarbonCarbonates[j,(4+(13*(i-1)))], rep(c('Median', 'MAD'),5),t(SoilCarbonCarbonates[,seq(7+((i-1)*13),7+9+((i-1)*13))])[,1] , SoilCarbonCarbonates[j,6+((i-1)*13)] ) ;
names(SCC.Data)<-c('YEAR' , 'SAMPLE' , 'ANALYSIS' ,'TYPE' , 'VALUE' , 'n');
SCC.Data
for ( i in seq(1,5) ) {
SCC.Data<-data.frame(SoilCarbonCarbonates[j,1], rep(seq(SoilCarbonCarbonates[j,2],SoilCarbonCarbonates[j,3]),each=2), SoilCarbonCarbonates[j,(4+(13*(i-1)))], rep(c('Median', 'MAD'),5),t(SoilCarbonCarbonates[,seq(7+((i-1)*13),7+9+((i-1)*13))])[,1] , SoilCarbonCarbonates[j,6+((i-1)*13)] ) ;
names(SCC.Data)<-c('YEAR' , 'SAMPLE' , 'ANALYSIS' ,'TYPE' , 'VALUE' , 'n');
SCC.Data
SCC.Data.1<-rbind(SCC.Data.0,SCC.Data)
SCC.Data.0<-SCC.Data.1
rm(SCC.Data,SCC.Data.1)
}
SCC.Data.0
SCC.Data<-data.frame(SoilCarbonCarbonates[j,1], rep(seq(SoilCarbonCarbonates[j,2],SoilCarbonCarbonates[j,3]),each=2), SoilCarbonCarbonates[j,(4+(13*(i-1)))], rep(c('Median', 'MAD'),5),t(SoilCarbonCarbonates[,seq(7+((i-1)*13),7+9+((i-1)*13))])[,1] , SoilCarbonCarbonates[j,6+((i-1)*13)] ) ;
SCC.Data
names(SCC.Data)<-c('YEAR' , 'SAMPLE' , 'ANALYSIS' ,'TYPE' , 'VALUE' , 'n');
SCC.Data
i
i=1
SCC.Data<-data.frame(SoilCarbonCarbonates[j,1], rep(seq(SoilCarbonCarbonates[j,2],SoilCarbonCarbonates[j,3]),each=2), SoilCarbonCarbonates[j,(4+(13*(i-1)))], rep(c('Median', 'MAD'),5),t(SoilCarbonCarbonates[,seq(7+((i-1)*13),7+9+((i-1)*13))])[,1] , SoilCarbonCarbonates[j,6+((i-1)*13)] ) ;
names(SCC.Data)<-c('YEAR' , 'SAMPLE' , 'ANALYSIS' ,'TYPE' , 'VALUE' , 'n');
SCC.Data
head(SoilCarbonCarbonates)
########### Going  along the analysis direction (Horizontal)  First and then along the year (vertical) second  #########
j=1
i=1
for ( i in seq(1,5) ) {
SCC.Data<-data.frame(SoilCarbonCarbonates[j,1], rep(seq(SoilCarbonCarbonates[j,2],SoilCarbonCarbonates[j,3]),each=2), SoilCarbonCarbonates[j,(4+(13*(i-1)))], rep(c('Median', 'MAD'),5),t(SoilCarbonCarbonates[,seq(7+((i-1)*13),7+9+((i-1)*13))])[,1] , SoilCarbonCarbonates[j,6+((i-1)*13)] ) ;
names(SCC.Data)<-c('YEAR' , 'SAMPLE' , 'ANALYSIS' ,'TYPE' , 'VALUE' , 'n');
SCC.Data
SCC.Data.1<-rbind(SCC.Data.0,SCC.Data)
SCC.Data.0<-SCC.Data.1
rm(SCC.Data,SCC.Data.1)
}
SCC.Data.0
########### Going  along the analysis direction (Horizontal)  First and then along the year (vertical) second  #########
j=1
rm(SCC.Data,SCC.Data.1)
for ( i in seq(1,5) ) {
SCC.Data<-data.frame(SoilCarbonCarbonates[j,1], rep(seq(SoilCarbonCarbonates[j,2],SoilCarbonCarbonates[j,3]),each=2), SoilCarbonCarbonates[j,(4+(13*(i-1)))], rep(c('Median', 'MAD'),5),t(SoilCarbonCarbonates[,seq(7+((i-1)*13),7+9+((i-1)*13))])[,1] , SoilCarbonCarbonates[j,6+((i-1)*13)] ) ;
names(SCC.Data)<-c('YEAR' , 'SAMPLE' , 'ANALYSIS' ,'TYPE' , 'VALUE' , 'n');
SCC.Data
SCC.Data.1<-rbind(SCC.Data.0,SCC.Data)
SCC.Data.0<-SCC.Data.1
rm(SCC.Data,SCC.Data.1)
}
SCC.Data.0
rm(SCC.Data,SCC.Data.1)
SCC.Data
SCC.Data.1<-rbind(SCC.Data.0,SCC.Data)
View(SCC.Data.0)
rm(SCC.Data.0)
########### Going  along the analysis direction (Horizontal)  First and then along the year (vertical) second  #########
j=1
for ( i in seq(1,5) ) {
SCC.Data<-data.frame(SoilCarbonCarbonates[j,1], rep(seq(SoilCarbonCarbonates[j,2],SoilCarbonCarbonates[j,3]),each=2), SoilCarbonCarbonates[j,(4+(13*(i-1)))], rep(c('Median', 'MAD'),5),t(SoilCarbonCarbonates[,seq(7+((i-1)*13),7+9+((i-1)*13))])[,1] , SoilCarbonCarbonates[j,6+((i-1)*13)] ) ;
names(SCC.Data)<-c('YEAR' , 'SAMPLE' , 'ANALYSIS' ,'TYPE' , 'VALUE' , 'n');
SCC.Data
SCC.Data.1<-rbind(SCC.Data.0,SCC.Data)
SCC.Data.0<-SCC.Data.1
rm(SCC.Data,SCC.Data.1)
}
SCC.Data<-data.frame(SoilCarbonCarbonates[j,1], rep(seq(SoilCarbonCarbonates[j,2],SoilCarbonCarbonates[j,3]),each=2), SoilCarbonCarbonates[j,(4+(13*(i-1)))], rep(c('Median', 'MAD'),5),t(SoilCarbonCarbonates[,seq(7+((i-1)*13),7+9+((i-1)*13))])[,1] , SoilCarbonCarbonates[j,6+((i-1)*13)] ) ;
SCC.Data
names(SCC.Data)<-c('YEAR' , 'SAMPLE' , 'ANALYSIS' ,'TYPE' , 'VALUE' , 'n');
SCC.Data
SCC.Data.0<-SCC.Data
SCC.Data.0<-SCC.Data
SCC.Data.0
rm(SCC.Data,SCC.Data.1)
for ( i in seq(1,5) ) {
SCC.Data<-data.frame(SoilCarbonCarbonates[j,1], rep(seq(SoilCarbonCarbonates[j,2],SoilCarbonCarbonates[j,3]),each=2), SoilCarbonCarbonates[j,(4+(13*(i-1)))], rep(c('Median', 'MAD'),5),t(SoilCarbonCarbonates[,seq(7+((i-1)*13),7+9+((i-1)*13))])[,1] , SoilCarbonCarbonates[j,6+((i-1)*13)] ) ;
names(SCC.Data)<-c('YEAR' , 'SAMPLE' , 'ANALYSIS' ,'TYPE' , 'VALUE' , 'n');
SCC.Data
SCC.Data.1<-rbind(SCC.Data.0,SCC.Data)
SCC.Data.0<-SCC.Data.1
rm(SCC.Data,SCC.Data.1)
}
View(SCC.Data.0)
for (j in seq(1,12))  {
for ( i in seq(1,5) ) {
SCC.Data<-data.frame(SoilCarbonCarbonates[j,1], rep(seq(SoilCarbonCarbonates[j,2],SoilCarbonCarbonates[j,3]),each=2), SoilCarbonCarbonates[j,(4+(13*(i-1)))], rep(c('Median', 'MAD'),5),t(SoilCarbonCarbonates[,seq(7+((i-1)*13),7+9+((i-1)*13))])[,1] , SoilCarbonCarbonates[j,6+((i-1)*13)] ) ;
names(SCC.Data)<-c('YEAR' , 'SAMPLE' , 'ANALYSIS' ,'TYPE' , 'VALUE' , 'n');
SCC.Data
SCC.Data.1<-rbind(SCC.Data.0,SCC.Data)
SCC.Data.0<-SCC.Data.1
rm(SCC.Data,SCC.Data.1)
}
}
View(SCC.Data.0)
j
SCC.Data<-data.frame(SoilCarbonCarbonates[j,1], rep(seq(SoilCarbonCarbonates[j,2],SoilCarbonCarbonates[j,3]),each=2), SoilCarbonCarbonates[j,(4+(13*(i-1)))], rep(c('Median', 'MAD'),5),t(SoilCarbonCarbonates[,seq(7+((i-1)*13),7+9+((i-1)*13))])[,1] , SoilCarbonCarbonates[j,6+((i-1)*13)] ) ;
names(SCC.Data)<-c('YEAR' , 'SAMPLE' , 'ANALYSIS' ,'TYPE' , 'VALUE' , 'n');
SCC.Data
i
SoilCarbonCarbonates[j,6+((i-1)*13)]
t(SoilCarbonCarbonates[,seq(7+((i-1)*13),7+9+((i-1)*13))])[,1]
t(SoilCarbonCarbonates[j,seq(7+((i-1)*13),7+9+((i-1)*13))])[,1]
rm(SCC.Data,SCC.Data.1)
rm(SCC.Data.0)
j=1
i=1
SCC.Data<-data.frame(SoilCarbonCarbonates[j,1], rep(seq(SoilCarbonCarbonates[j,2],SoilCarbonCarbonates[j,3]),each=2), SoilCarbonCarbonates[j,(4+(13*(i-1)))], rep(c('Median', 'MAD'),5),t(SoilCarbonCarbonates[j,seq(7+((i-1)*13),7+9+((i-1)*13))])[,1] , SoilCarbonCarbonates[j,6+((i-1)*13)] ) ;
names(SCC.Data)<-c('YEAR' , 'SAMPLE' , 'ANALYSIS' ,'TYPE' , 'VALUE' , 'n');
SCC.Data
print(SCC.Data)
SCC.Data.0<-SCC.Data
rm(SCC.Data,SCC.Data.1)
for (j in seq(1,12))  {
for ( i in seq(1,5) ) {
SCC.Data<-data.frame(SoilCarbonCarbonates[j,1], rep(seq(SoilCarbonCarbonates[j,2],SoilCarbonCarbonates[j,3]),each=2), SoilCarbonCarbonates[j,(4+(13*(i-1)))], rep(c('Median', 'MAD'),5),t(SoilCarbonCarbonates[j,seq(7+((i-1)*13),7+9+((i-1)*13))])[,1] , SoilCarbonCarbonates[j,6+((i-1)*13)] ) ;
names(SCC.Data)<-c('YEAR' , 'SAMPLE' , 'ANALYSIS' ,'TYPE' , 'VALUE' , 'n');
print(SCC.Data)
SCC.Data.1<-rbind(SCC.Data.0,SCC.Data)
SCC.Data.0<-SCC.Data.1
rm(SCC.Data,SCC.Data.1)
}
}
writeWorksheetToFile("Results_data_all.xlsx",SCC.Data.0, sheet="Carbon and Carbonates table") ;
writeWorksheetToFile("Results_data_all.xlsx",SCC.Data.0, sheet="Carbon and Carbonates table") ;
writeWorksheetToFile("Results_data_all.xlsx",SCC.Data.0, sheet="Carbon and Carbonates table") ;
i=1
j=1
SCC.Data<-data.frame(SoilCarbonCarbonates[j,1], rep(seq(SoilCarbonCarbonates[j,2],SoilCarbonCarbonates[j,3]),each=2), SoilCarbonCarbonates[j,(4+(13*(i-1)))], rep(c('Median', 'MAD'),5),t(SoilCarbonCarbonates[j,seq(7+((i-1)*13),7+9+((i-1)*13))])[,1] , SoilCarbonCarbonates[j,6+((i-1)*13)] ) ;
names(SCC.Data)<-c('YEAR' , 'SAMPLE' , 'ANALYSIS' ,'TYPE' , 'VALUE' , 'n');
SoilCarbonCarbonates<-readWorksheetFromFile("Results_data_all.xlsx", sheet="Carbon and carbonates", header=T, startRow=2) ;
head(SoilCarbonCarbonates)
str(SoilCarbonCarbonates)
i=1
j=1
SCC.Data.0<-data.frame(SoilCarbonCarbonates[j,1], rep(seq(SoilCarbonCarbonates[j,2],SoilCarbonCarbonates[j,3]),each=2), SoilCarbonCarbonates[j,(4+(13*(i-1)))], rep(c('Median', 'MAD'),5),t(SoilCarbonCarbonates[j,seq(7+((i-1)*13),7+9+((i-1)*13))])[,1] , SoilCarbonCarbonates[j,6+((i-1)*13)] ) ;
names(SCC.Data.0)<-c('YEAR' , 'SAMPLE' , 'ANALYSIS' ,'TYPE' , 'VALUE' , 'n');
SCC.Data.0
for (j in seq(1,12))  {
for ( i in seq(1,5) ) {
SCC.Data<-data.frame(SoilCarbonCarbonates[j,1], rep(seq(SoilCarbonCarbonates[j,2],SoilCarbonCarbonates[j,3]),each=2), SoilCarbonCarbonates[j,(4+(13*(i-1)))], rep(c('Median', 'MAD'),5),t(SoilCarbonCarbonates[j,seq(7+((i-1)*13),7+9+((i-1)*13))])[,1] , SoilCarbonCarbonates[j,6+((i-1)*13)] ) ;
names(SCC.Data)<-c('YEAR' , 'SAMPLE' , 'ANALYSIS' ,'TYPE' , 'VALUE' , 'n');
print(SCC.Data)
SCC.Data.1<-rbind(SCC.Data.0,SCC.Data)
SCC.Data.0<-SCC.Data.1
rm(SCC.Data,SCC.Data.1)
}
}
writeWorksheetToFile("Results_data_all.xlsx",SCC.Data.0, sheet="Carbon and Carbonates table") ;
