str(Node.names.scraping_NAPT)
Soils.NAPT<-which(Node.names.scraping_NAPT == "Soil") ;
length(Lab_Results[Soils.NAPT])
head(Lab_Results[Soils.NAPT])
Soil.NAPT.paths<-strsplit(as.character(Lab_Results[Soils.NAPT]), split='"') ;
str(Soil.NAPT.paths)
NAPT.pdfs.1<-sapply(Soil.NAPT.paths,'[',2) ;
NAPT.paths<-paste0('http://www.naptprogram.org/',NAPT.pdfs.1) ;
Results.data.all<-Results.data.1
Archive.files<-list.files("../NAPT_PDFs")
#################### Files that have one method of soil analysis
Archive.files[(grep("Copy.pdf$",Archive.files))] ;
Archive.files.comp<- Archive.files[which(!seq(1,length(Archive.files))%in% grep("Copy.pdf$",Archive.files))] ;
Hygrometer.Soils<-c(Archive.files[grep("Copy.pdf$",Archive.files)], Archive.files.comp[27:40]) ;
TwoMethods.Soils<-Archive.files.comp[1:26] ;
out.1 <- extract_tables(paste0("../NAPT_PDFs/", Hygrometer.Soils[1])) ;
library(tabulizer)
library(dplyr)
out.1 <- extract_tables(paste0("../NAPT_PDFs/", Hygrometer.Soils[1])) ;
pdf.data.1<-(out.1[[length(out.1)]]);
pdf.data.1<-t(out.1[[length(out.1)]]);
pdf.data.1
select.columns<-sort(c(grep('Sand.*',pdf.data.1[1,]),grep('Silt.*',pdf.data.1[1,]),grep('Clay.*',pdf.data.1[1,])));
pdf.data.1[,select.columns]
row.names(pdf.data.1[,select.columns])
analysis.names
row.names(pdf.data.1[,select.columns])<-analysis.names
analysis.names<-c("Analysis" , "Units" , "n", as.vector(t(temp)))
out.1 <- extract_tables(paste0("../NAPT_PDFs/", Hygrometer.Soils[1])) ;
str(out.1)
length(out.1)
out.1[[1]]
str(out.1[[1]])
soil.names<-out.1[[1]][1,grep("Soil .*",out.1[[1]][1,])]
temp<-matrix(c(paste(soil.names,c("Median"),sep='_'),paste(soil.names,c("MAD"),sep='_')),nrow=length(soil.names),ncol=2)
Soil_names<-as.vector(t(temp))
analysis.names<-c("Analysis" , "Units" , "n", as.vector(t(temp)))
pdf.data.1<-t(out.1[[length(out.1)]]);
row.names(pdf.data.1)<-analysis.names
pdf.data.1
select.columns<-sort(c(grep('Sand.*',pdf.data.1[1,]),grep('Silt.*',pdf.data.1[1,]),grep('Clay.*',pdf.data.1[1,])));
Results.data.1<-pdf.data.1[,select.columns]
Results.data.1
seq(2,length(Hygrometer.Soils))
out<- extract_tables(paste0("../NAPT_PDFs/", Hygrometer.Soils[2])) ;
str(out)
length(out)
out[[1]]
str(out[[1]])
soil.names<-out[[1]][1,grep("Soil .*",out[[1]][1,])]
soil.names
temp<-matrix(c(paste(soil.names,c("Median"),sep='_'),paste(soil.names,c("MAD"),sep='_')),nrow=length(soil.names),ncol=2)
Soil_names<-as.vector(t(temp))
analysis.names<-c("Analysis" , "Units" , "n", as.vector(t(temp)))
pdf.data<-t(out[[length(out)]]);
row.names(pdf.data)<-analysis.names
pdf.data
row.names(pdf.data)<-analysis.names
str(pdf.data)
analysis.names
pdf.data
out[[length(out)]]
rm('out')
out<- extract_tables(paste0("../NAPT_PDFs/", Hygrometer.Soils[3])) ;
str(out)
length(out)
out[[1]]
rm('out')
out<- extract_tables(paste0("../NAPT_PDFs/", Hygrometer.Soils[4])) ;
str(out)
length(out)
out[[1]]
str(out[[1]])
out[[1]]
out[[1]]
str(out[[1]])
soil.names<-out[[1]][1,grep("Soil .*",out[[1]][1,])]
temp<-matrix(c(paste(soil.names,c("Median"),sep='_'),paste(soil.names,c("MAD"),sep='_')),nrow=length(soil.names),ncol=2)
Soil_names<-as.vector(t(temp))
analysis.names<-c("Analysis" , "Units" , "n", as.vector(t(temp)))
pdf.data<-t(out[[length(out)]]);
row.names(pdf.data)<-analysis.names
str(pdf.data)
select.columns<-sort(c(grep('Sand.*',pdf.data.1[1,]),grep('Silt.*',pdf.data.1[1,]),grep('Clay.*',pdf.data.1[1,])));
Results.data.1<-pdf.data.1[,select.columns]
Results.data.1
library(tabulizer)
library(dplyr)
out.1 <- extract_tables(paste0("../NAPT_PDFs/", Hygrometer.Soils[1])) ;
str(out.1)
length(out.1)
out.1[[1]]
str(out.1[[1]])
soil.names<-out.1[[1]][1,grep("Soil .*",out.1[[1]][1,])]
temp<-matrix(c(paste(soil.names,c("Median"),sep='_'),paste(soil.names,c("MAD"),sep='_')),nrow=length(soil.names),ncol=2)
Soil_names<-as.vector(t(temp))
analysis.names<-c("Analysis" , "Units" , "n", as.vector(t(temp)))
pdf.data.1<-t(out.1[[length(out.1)]]);
row.names(pdf.data.1)<-analysis.names
str(pdf.data.1)
select.columns<-sort(c(grep('Sand.*',pdf.data.1[1,]),grep('Silt.*',pdf.data.1[1,]),grep('Clay.*',pdf.data.1[1,])));
Results.data.1<-pdf.data.1[,select.columns]
Results.data.1
rm('out')
out<- extract_tables(paste0("../NAPT_PDFs/", Hygrometer.Soils[2])) ;
str(out)
length(out)
out[[1]]
str(out[[1]])
soil.names<-out[[1]][1,grep("Soil .*",out[[1]][1,])]
soil.names
temp<-matrix(c(paste(soil.names,c("Median"),sep='_'),paste(soil.names,c("MAD"),sep='_')),nrow=length(soil.names),ncol=2)
Soil_names<-as.vector(t(temp))
analysis.names<-c("Analysis" , "Units" , "n", as.vector(t(temp)))
pdf.data<-t(out[[length(out)]]);
str(pdf.data)
dim(pdf.data)
seq(1,dim(pdf.data)[1])
analysis.names[seq(1,dim(pdf.data)[1])]
row.names(pdf.data)<-analysis.names[seq(1,dim(pdf.data)[1])]
str(pdf.data)
select.columns<-sort(c(grep('Sand.*',pdf.data.1[1,]),grep('Silt.*',pdf.data.1[1,]),grep('Clay.*',pdf.data.1[1,])));
Results.data.1<-pdf.data.1[,select.columns]
############# combine the data with the previous pdf data ###########
str(Results.data.1)
str(Results.data)
p
pdf.data<-t(out[[length(out)]]);
row.names(pdf.data)<-analysis.names[seq(1,dim(pdf.data)[1])]
str(pdf.data)
select.columns<-sort(c(grep('Sand.*',pdf.data[1,]),grep('Silt.*',pdf.data[1,]),grep('Clay.*',pdf.data[1,])));
Results.data<-pdf.data[,select.columns]
Results.data
############# combine the data with the previous pdf data ###########
str(Results.data)
Results.data.all<-pdf.data.1[,select.columns]
Results.data.all<-pdf.data.1[,select.columns]
.libPaths("C:/Felipe/SotwareANDCoding/R_Library/library")  ;
# Preliminaries
rm(list = ls())
setwd("C:/Felipe/LaserDifractionSoilTextureAnalysis/NAPTSoilsData") ;
# httr is a package for downloading html
library(httr)
# A package for manipulating strings
library(stringr)
# Lets start by downloading an example web page:
url <- "http://www.naptprogram.org/lab-results/program-archive"
# We start by using the httr package to download the source html
page <- httr::GET(url)
# As we can see, this produces a great deal of information
str(page)
# To get at the actual content of the page, we use the content() function:
page_content <- httr::content(page, "text")
# Now lets print it out
cat(page_content)
url.NAPT<-"http://www.naptprogram.org/lab-results/program-archive"
NAPT.page<-httr::GET(url.NAPT)
library(XML)
library(rvest)
library(magrittr)
scraping_NAPT <- read_html ("http://www.naptprogram.org/lab-results")
Lab_Results   <- scraping_NAPT %>%
html_nodes ("td>a")
length(Lab_Results)
Node.names.scraping_NAPT<-html_text(Lab_Results) ;
str(Node.names.scraping_NAPT)
Soils.NAPT<-which(Node.names.scraping_NAPT == "Soil") ;
length(Lab_Results[Soils.NAPT])
head(Lab_Results[Soils.NAPT])
Soil.NAPT.paths<-strsplit(as.character(Lab_Results[Soils.NAPT]), split='"') ;
str(Soil.NAPT.paths)
NAPT.pdfs.1<-sapply(Soil.NAPT.paths,'[',2) ;
NAPT.paths<-paste0('http://www.naptprogram.org/',NAPT.pdfs.1) ;
Results.data.all<-Results.data.1
Archive.files<-list.files("../NAPT_PDFs")
#################### Files that have one method of soil analysis
Archive.files[(grep("Copy.pdf$",Archive.files))] ;
Archive.files.comp<- Archive.files[which(!seq(1,length(Archive.files))%in% grep("Copy.pdf$",Archive.files))] ;
Hygrometer.Soils<-c(Archive.files[grep("Copy.pdf$",Archive.files)], Archive.files.comp[27:40]) ;
library(tabulizer)
library(dplyr)
NAPT.paths<-paste0('http://www.naptprogram.org/',NAPT.pdfs.1) ;
Results.data.all<-Results.data.1
Archive.files<-list.files("../NAPT_PDFs")
#################### Files that have one method of soil analysis
Archive.files[(grep("Copy.pdf$",Archive.files))] ;
Archive.files.comp<- Archive.files[which(!seq(1,length(Archive.files))%in% grep("Copy.pdf$",Archive.files))] ;
Hygrometer.Soils<-c(Archive.files[grep("Copy.pdf$",Archive.files)], Archive.files.comp[27:40]) ;
library(tabulizer)
library(dplyr)
out.1 <- extract_tables(paste0("../NAPT_PDFs/", Hygrometer.Soils[1])) ;
str(out.1)
length(out.1)
out.1[[1]]
str(out.1[[1]])
str(out.1[[1]])
soil.names<-out.1[[1]][1,grep("Soil .*",out.1[[1]][1,])]
temp<-matrix(c(paste(soil.names,c("Median"),sep='_'),paste(soil.names,c("MAD"),sep='_')),nrow=length(soil.names),ncol=2)
Soil_names<-as.vector(t(temp))
analysis.names<-c("Analysis" , "Units" , "n", as.vector(t(temp)))
pdf.data.1<-t(out.1[[length(out.1)]]);
row.names(pdf.data.1)<-analysis.names
str(pdf.data.1)
select.columns<-sort(c(grep('Sand.*',pdf.data.1[1,]),grep('Silt.*',pdf.data.1[1,]),grep('Clay.*',pdf.data.1[1,])));
Results.data.all<-pdf.data.1[,select.columns]
rm('out')
data.1<-Results.data.all
out<- extract_tables(paste0("../NAPT_PDFs/", Hygrometer.Soils[2])) ;
str(out)
length(out)
out[[1]]
str(out[[1]])
soil.names<-out[[1]][1,grep("Soil .*",out[[1]][1,])]
temp<-matrix(c(paste(soil.names,c("Median"),sep='_'),paste(soil.names,c("MAD"),sep='_')),nrow=length(soil.names),ncol=2)
Soil_names<-as.vector(t(temp))
analysis.names<-c("Analysis" , "Units" , "n", as.vector(t(temp)))
pdf.data<-t(out[[length(out)]]);
row.names(pdf.data)<-analysis.names[seq(1,dim(pdf.data)[1])]
str(pdf.data)
select.columns<-sort(c(grep('Sand.*',pdf.data[1,]),grep('Silt.*',pdf.data[1,]),grep('Clay.*',pdf.data[1,])));
Results.data<-pdf.data[,select.columns]
############# combine the data with the previous pdf data ###########
str(Results.data)
str(Results.data)
############# combine the data with the previous pdf data ###########
str(Results.data)
str(Results.data)
Results.data.all<-rbind(Results.data,Results.data.all)
str(Results.data.all.2)
str(Results.data.all)
rm('out', 'Results.data')
data.1<-Results.data.all
Results.data.all
##############Get the rest of the data and combine it #####################
for (i in seq(2,length(Hygrometer.Soils))) {
rm('out', 'Results.data')
data.1<-Results.data.all
out<- extract_tables(paste0("../NAPT_PDFs/", Hygrometer.Soils[i])) ;
str(out)
length(out)
out[[1]]
str(out[[1]])
soil.names<-out[[1]][1,grep("Soil .*",out[[1]][1,])]
temp<-matrix(c(paste(soil.names,c("Median"),sep='_'),paste(soil.names,c("MAD"),sep='_')),nrow=length(soil.names),ncol=2)
Soil_names<-as.vector(t(temp))
analysis.names<-c("Analysis" , "Units" , "n", as.vector(t(temp)))
############## get the data from the table ###############
pdf.data<-t(out[[length(out)]]);
row.names(pdf.data)<-analysis.names[seq(1,dim(pdf.data)[1])]
str(pdf.data)
select.columns<-sort(c(grep('Sand.*',pdf.data[1,]),grep('Silt.*',pdf.data[1,]),grep('Clay.*',pdf.data[1,])));
Results.data<-pdf.data[,select.columns]
############# combine the data with the previous pdf data ###########
str(Results.data)
str(Results.data)
Results.data.all<-rbind(Results.data,Results.data.all)
str(Results.data.all)
}
i
i=10
#i=10
rm('out', 'Results.data')
data.1<-Results.data.all
out<- extract_tables(paste0("../NAPT_PDFs/", Hygrometer.Soils[i])) ;
str(out)
length(out)
out[[1]]
str(out[[1]])
soil.names<-out[[1]][1,grep("Soil .*",out[[1]][1,])]
temp<-matrix(c(paste(soil.names,c("Median"),sep='_'),paste(soil.names,c("MAD"),sep='_')),nrow=length(soil.names),ncol=2)
Soil_names<-as.vector(t(temp))
analysis.names<-c("Analysis" , "Units" , "n", as.vector(t(temp)))
soil.names<-out[[1]][1,grep("Soil .*",out[[1]][1,])]
soil.names
out<- extract_tables(paste0("../NAPT_PDFs/", Hygrometer.Soils[i])) ;
out
(paste0("../NAPT_PDFs/", Hygrometer.Soils[i])
)
i=11
#i=11
rm('out', 'Results.data')
data.1<-Results.data.all
out<- extract_tables(paste0("../NAPT_PDFs/", Hygrometer.Soils[i])) ;
out
str(out)
length(out)
out[[1]]
str(out[[1]])
soil.names<-out[[1]][1,grep("Soil .*",out[[1]][1,])]
temp<-matrix(c(paste(soil.names,c("Median"),sep='_'),paste(soil.names,c("MAD"),sep='_')),nrow=length(soil.names),ncol=2)
Soil_names<-as.vector(t(temp))
str(out)
length(out)
out[[1]]
str(out[[1]])
soil.names<-out[[1]][1,grep("Soil .*",out[[1]][1,])]
soil.names
paste0("../NAPT_PDFs/", Hygrometer.Soils[i])
out[[2]]
str(out[[2]])
soil.names<-out[[1]][1,grep("Soil .*",out[[1]][1,])]
temp<-matrix(c(paste(soil.names,c("Median"),sep='_'),paste(soil.names,c("MAD"),sep='_')),nrow=length(soil.names),ncol=2)
soil.names
soil.names<-out[[2]][1,grep("Soil .*",out[[2]][1,])]
temp<-matrix(c(paste(soil.names,c("Median"),sep='_'),paste(soil.names,c("MAD"),sep='_')),nrow=length(soil.names),ncol=2)
Soil_names<-as.vector(t(temp))
analysis.names<-c("Analysis" , "Units" , "n", as.vector(t(temp)))
pdf.data<-t(out[[length(out)]]);
row.names(pdf.data)<-analysis.names[seq(1,dim(pdf.data)[1])]
str(pdf.data)
select.columns<-sort(c(grep('Sand.*',pdf.data[1,]),grep('Silt.*',pdf.data[1,]),grep('Clay.*',pdf.data[1,])));
Results.data<-pdf.data[,select.columns]
############# combine the data with the previous pdf data ###########
str(Results.data)
str(Results.data)
Results.data.all<-rbind(Results.data,Results.data.all)
str(Results.data.all)
seq(12,length(Hygrometer.Soils))
##############Get the rest of the data and combine it #####################
for (i in seq(12,length(Hygrometer.Soils))) {
#i=11
rm('out', 'Results.data')
data.1<-Results.data.all
out<- extract_tables(paste0("../NAPT_PDFs/", Hygrometer.Soils[i])) ;
str(out)
length(out)
out[[2]]
str(out[[2]])
soil.names<-out[[2]][1,grep("Soil .*",out[[2]][1,])]
temp<-matrix(c(paste(soil.names,c("Median"),sep='_'),paste(soil.names,c("MAD"),sep='_')),nrow=length(soil.names),ncol=2)
Soil_names<-as.vector(t(temp))
analysis.names<-c("Analysis" , "Units" , "n", as.vector(t(temp)))
############## get the data from the table ###############
pdf.data<-t(out[[length(out)]]);
row.names(pdf.data)<-analysis.names[seq(1,dim(pdf.data)[1])]
str(pdf.data)
select.columns<-sort(c(grep('Sand.*',pdf.data[1,]),grep('Silt.*',pdf.data[1,]),grep('Clay.*',pdf.data[1,])));
Results.data<-pdf.data[,select.columns]
############# combine the data with the previous pdf data ###########
str(Results.data)
str(Results.data)
Results.data.all<-rbind(Results.data,Results.data.all)
str(Results.data.all)
}
i
Hygrometer.Soils[i]
i
#i=14
rm('out', 'Results.data')
data.1<-Results.data.all
out<- extract_tables(paste0("../NAPT_PDFs/", Hygrometer.Soils[i])) ;
out
i=15
i=15
#i=15
rm('out', 'Results.data')
data.1<-Results.data.all
out<- extract_tables(paste0("../NAPT_PDFs/", Hygrometer.Soils[i])) ;
out
Hygrometer.Soils[i]
i=16
#i=16
rm('out', 'Results.data')
data.1<-Results.data.all
out<- extract_tables(paste0("../NAPT_PDFs/", Hygrometer.Soils[i])) ;
out
Hygrometer.Soils[i]
Results.data.all
getwd()
write.csv(Results.data.all,file='Results_data_all.csv',quote=F)
#write.csv(Results.data.all,file='Results_data_all.csv',quote=F)
library(XLConnect) ;
writeWorksheetToFile("Results_data_all.xlsx",Results.data.all,sheet="Results_data_all")
getwd()
writeWorksheetToFile("Results_data_all.xlsx",Results.data.all,sheet="Results_data_all",row.names=T)
Results.data.all$names<-row.names(Results.data.all)
Results.data.all
Results.data.all
row.names(Results.data.all)
#write.csv(Results.data.all,file='Results_data_all.csv',quote=F)
Results.data.all<-read.csv() ('Results_data_all.csv',header=T, as.is=T)
#write.csv(Results.data.all,file='Results_data_all.csv',quote=F)
Results.data.all<-read.csv('Results_data_all.csv',header=T, as.is=T)
Results.data.all
row.names(Results.data.all)
writeWorksheetToFile("Results_data_all.xlsx",Results.data.all,sheet="Results_data_all",row.names=T)
writeWorksheetToFile("Results_data_all.xlsx",Results.data.all,sheet="Results_data_all")
TwoMethods.Soils<-Archive.files.comp[1:26] ;
rm('out.1', 'Results.data')
rm('out.1', 'out' , 'Results.data', 'Results.data.all')
paste0("../NAPT_PDFs/", TwoMethods.Soils[1])
out.1 <- extract_tables(paste0("../NAPT_PDFs/", TwoMethods.Soils[1])) ;
str(out.1)
length(out.1)
out.1[[1]]
str(out.1[[1]])
length(out.1)
out.1[[1]]
str(out.1[[1]])
soil.names<-out.1[[1]][1,grep("Soil .*",out.1[[1]][1,])]
soil.names
temp<-matrix(c(paste(soil.names,c("Median"),sep='_'),paste(soil.names,c("MAD"),sep='_')),nrow=length(soil.names),ncol=2)
Soil_names<-as.vector(t(temp))
analysis.names<-c("Analysis" , "Units" , "n", as.vector(t(temp)))
analysis.names
pdf.data.1<-t(out.1[[length(out.1)]]);
row.names(pdf.data.1)<-analysis.names
str(pdf.data.1)
select.columns<-sort(c(grep('Sand.*',pdf.data.1[1,]),grep('Silt.*',pdf.data.1[1,]),grep('Clay.*',pdf.data.1[1,])));
Results.data.all<-pdf.data.1[,select.columns]
Results.data.all
seq(2,length(TwoMethods.Soils))
#i=16
rm('out', 'Results.data')
data.1<-Results.data.all
paste0("../NAPT_PDFs/", Hygrometer.Soils[2])
paste0("../NAPT_PDFs/", TwoMethods.Soils[2])
out<- extract_tables(paste0("../NAPT_PDFs/", TwoMethods.Soils[2])) ;
str(out)
length(out)
out[[2]]
str(out[[2]])
soil.names<-out[[2]][1,grep("Soil .*",out[[2]][1,])]
soil.names
str(out)
length(out)
out[[1]]
str(out[[1]])
soil.names
out[[1]]
soil.names<-out.1[[1]][1,grep("Soil.*",out.1[[1]][1,])]
soil.names
pdf.data.1<-t(out.1[[length(out.1)]]);
pdf.data.1
#i=16
rm('out', 'Results.data')
data.1<-Results.data.all
out<- extract_tables(paste0("../NAPT_PDFs/", TwoMethods.Soils[2])) ;
str(out)
length(out)
out[[1]]
out[[1]][1,
]
grep("Soil.*",out[[1]][1,])
soil.names<-grep("Soil.*",out[[1]][1,])
soil.names<-grep("Soil.*",out[[1]][1,])
soil.names
soil.names<-out[[1]][1,grep("Soil.*",out[[1]][1,])]
soil.names
soil.names<-out[[1]][1,grep("Soil.*",out[[1]][1,])] ;
temp<-matrix(c(paste(soil.names,c("Median"),sep='_'),paste(soil.names,c("MAD"),sep='_')),nrow=length(soil.names),ncol=2)
Soil_names<-as.vector(t(temp))
analysis.names<-c("Analysis" , "Units" , "n", as.vector(t(temp)))
pdf.data<-t(out[[length(out)]]);
row.names(pdf.data)<-analysis.names[seq(1,dim(pdf.data)[1])]
str(pdf.data)
select.columns<-sort(c(grep('Sand.*',pdf.data[1,]),grep('Silt.*',pdf.data[1,]),grep('Clay.*',pdf.data[1,])));
Results.data<-pdf.data[,select.columns]
############# combine the data with the previous pdf data ###########
str(Results.data)
str(Results.data)
Results.data.all<-rbind(Results.data,Results.data.all)
str(Results.data.all)
Results.data.all
##############Get the rest of the data and combine it #####################
for (i in seq(3,length(TwoMethods.Soils))) {
#i=16
rm('out', 'Results.data')
data.1<-Results.data.all
out<- extract_tables(paste0("../NAPT_PDFs/", TwoMethods.Soils[2])) ;
str(out)
length(out)
out[[1]]
str(out[[1]])
soil.names<-out[[1]][1,grep("Soil.*",out[[1]][1,])] ;
temp<-matrix(c(paste(soil.names,c("Median"),sep='_'),paste(soil.names,c("MAD"),sep='_')),nrow=length(soil.names),ncol=2)
Soil_names<-as.vector(t(temp))
analysis.names<-c("Analysis" , "Units" , "n", as.vector(t(temp)))
############## get the data from the table ###############
pdf.data<-t(out[[length(out)]]);
row.names(pdf.data)<-analysis.names[seq(1,dim(pdf.data)[1])]
str(pdf.data)
select.columns<-sort(c(grep('Sand.*',pdf.data[1,]),grep('Silt.*',pdf.data[1,]),grep('Clay.*',pdf.data[1,])));
Results.data<-pdf.data[,select.columns]
############# combine the data with the previous pdf data ###########
str(Results.data)
str(Results.data)
Results.data.all<-rbind(Results.data,Results.data.all)
str(Results.data.all)
}
write.csv(Results.data.all,file='Results_data_all_two.csv',quote=F)
writeWorksheetToFile("Results_data_all.xlsx",Results.data.all,sheet="Results_data_all_two")
out.1 <- extract_tables(paste0("../NAPT_PDFs/", Hygrometer.Soils[1])) ;
str(out.1)
length(out.1)
out.1[[1]]
str(out.1[[1]])
soil.names<-out.1[[1]][1,grep("Soil .*",out.1[[1]][1,])]
temp<-matrix(c(paste(soil.names,c("Median"),sep='_'),paste(soil.names,c("MAD"),sep='_')),nrow=length(soil.names),ncol=2)
Soil_names<-as.vector(t(temp))
analysis.names<-c("Analysis" , "Units" , "n", as.vector(t(temp)))
pdf.data.1<-t(out.1[[length(out.1)]]);
row.names(pdf.data.1)<-analysis.names
str(pdf.data.1)
select.columns<-sort(c(grep('Sand.*',pdf.data.1[1,]),grep('Silt.*',pdf.data.1[1,]),grep('Clay.*',pdf.data.1[1,])));
Results.data.all<-pdf.data.1[,select.columns]
pdf.data.1[,select.columns]
Results.data.all<-read.csv('Results_data_all_two.csv',header=T, as.is=T)
Results.data.all<-read.csv('Results_data_all_two.csv',header=T, as.is=T)
Results.data.all
writeWorksheetToFile("Results_data_all.xlsx",Results.data.all,sheet="Results_data_all_two")
writeWorksheetToFile("Results_data_all.xlsx",Results.data.all,sheet="Results_data_all_two")
