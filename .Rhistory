SCC.Data.1<-rbind(SCC.Data.0,SCC.Data)
SCC.Data.0<-SCC.Data.1
rm(SCC.Data,SCC.Data.1)
}
}
SCC.Data.0
head(SCC.Data.0)
writeWorksheetToFile("Results_data_all.xlsx",SCC.Data.0[-c(1:10),], sheet="Carbon and Carbonates table") ;
writeWorksheetToFile("Results_data_all.xlsx",SCC.Data.0[-c(1:10),], sheet="Carbon and Carbonates table") ;
SRS_1604_SRS_1508<-readWorksheetFromFile("Results_data_all.xlsx", sheet="Carbon and carbonatesOriginal", header=T, startRow=1, endRow=13, startCol=42, endCol=48 ) ;
SRS_1604_SRS_1508
SRS_1604_SRS_1508<-readWorksheetFromFile("Results_data_all.xlsx", sheet="Carbon and carbonatesOriginal", header=T, startRow=1, endRow=13, startCol=38, endCol=43 ) ;
SRS_1604_SRS_1508
SRS_1604_SRS_1508<-readWorksheetFromFile("Results_data_all.xlsx", sheet="Carbon and carbonatesOriginal", header=T, startRow=1, endRow=17, startCol=38, endCol=43 ) ;
SRS_1604_SRS_1508
head(SCC.Data.0)
SRS_1604_SRS_1508
SRS_1604_SRS_1508<-readWorksheetFromFile("Results_data_all.xlsx", sheet="Carbon and carbonatesOriginal", header=T, startRow=1, endRow=17, startCol=38, endCol=43 ) ;
SRS_1604_SRS_1508
head(SCC.Data.0)
rbind(SCC.Data.0, SRS_1604_SRS_1508)
SCC.Data.all<-rbind(SCC.Data.0, SRS_1604_SRS_1508)
tail(SCC.Data.all)
tail(SCC.Data.all,13)
tail(SCC.Data.all,20)
SCC.Data.0
head(SCC.Data.0)
SRS_1604_SRS_1508<-readWorksheetFromFile("Results_data_all.xlsx", sheet="Carbon and carbonatesOriginal", header=T, startRow=1, endRow=17, startCol=38, endCol=43 ) ;
SCC.Data.all<-rbind(SCC.Data.0, SRS_1604_SRS_1508)
tail(SCC.Data.all,20)
writeWorksheetToFile("Results_data_all.xlsx",SCC.Data.0[-c(1:10),], sheet="Carbon and Carbonates table") ;
writeWorksheetToFile("Results_data_all.xlsx",SCC.Data.0[-c(1:10),], sheet="Carbon and Carbonates table") ;
writeWorksheetToFile("Results_data_all.xlsx",SCC.Data.all[-c(1:10),], sheet="Carbon and Carbonates table") ;
writeWorksheetToFile("Results_data_all.xlsx",SCC.Data.all[-c(1:10),], sheet="Carbon and Carbonates table") ;
CarbonANDCarbonates.data<-SCC.Data.all[-c(1:10),] ;
CarbonANDCarbonates.data$Sample.ID<-paste0(CarbonANDCarbonates.data$YEAR,"-",CarbonANDCarbonates.data$SAMPLE) ;
CarbonANDCarbonates.noMAD.data<-CarbonANDCarbonates.data[which(CarbonANDCarbonates.data$TYPE == c('Median')),] ;
str(CarbonANDCarbonates.noMAD.data)
levels(CarbonANDCarbonates.noMAD.data$ANALYSIS)
head(CarbonANDCarbonates.noMAD.data)
tail(CarbonANDCarbonates.noMAD.data)
TOC<-CarbonANDCarbonates.data[which(CarbonANDCarbonates.data$TYPE == c('Median') & CarbonANDCarbonates.data$ANALYSIS == c('Soil TOC (Combustion)')),]  ;
TC<-CarbonANDCarbonates.data[which(CarbonANDCarbonates.data$TYPE == c('Median') & CarbonANDCarbonates.data$ANALYSIS == c('Soil Total C (Combustion)')),]  ;
SOM_Walkley<-CarbonANDCarbonates.data[which(CarbonANDCarbonates.data$TYPE == c('Median') & CarbonANDCarbonates.data$ANALYSIS == c('SOM - Walkley-Black')),]  ;
SOM_LOI<-CarbonANDCarbonates.data[which(CarbonANDCarbonates.data$TYPE == c('Median') & CarbonANDCarbonates.data$ANALYSIS == c('SOM - LOI (% Wt loss)')),]  ;
CaCO3<-CarbonANDCarbonates.data[which(CarbonANDCarbonates.data$TYPE == c('Median') & CarbonANDCarbonates.data$ANALYSIS == c('CaCO3 Content')),]  ;
Soil_C_CaCO3.1<-merge(TOC[,c('ANALYSIS', 'VALUE' , 'Sample.ID')],TC[,c('ANALYSIS', 'VALUE' , 'Sample.ID')] , by="Sample.ID") ;
Soil_C_CaCO3.2<-merge(SOM_Walkley[,c('ANALYSIS', 'VALUE' , 'Sample.ID')],SOM_LOI[,c('ANALYSIS', 'VALUE' , 'Sample.ID')] , by="Sample.ID") ;
Soil_C_CaCO3.3<-merge(Soil_C_CaCO3.2, CaCO3[,c('ANALYSIS', 'VALUE' , 'Sample.ID')] , by="Sample.ID") ;
Soil_C_CaCO3.4<-merge(Soil_C_CaCO3.3, Soil_C_CaCO3.1, by="Sample.ID") ;
head(Soil_C_CaCO3.4)
Soil_C_CaCO3<-Soil_C_CaCO3.4[,c('Sample.ID', 'VALUE.x.x' , 'VALUE.y.x' , 'VALUE' , 'VALUE.x.y' , 'VALUE.y.y')] ;
names(Soil_C_CaCO3)<-c('Sample.ID','SOM - Walkley-Black', 'SOM - LOI (% Wt loss)','CaCO3 Content' ,'Soil TOC (Combustion)' , 'Soil Total C (Combustion)')
head(Soil_C_CaCO3)
tail(Soil_C_CaCO3)
tail(CarbonANDCarbonates.noMAD.data)
levels(CarbonANDCarbonates.noMAD.data$ANALYSIS)
TOC<-CarbonANDCarbonates.data[which(CarbonANDCarbonates.data$TYPE == c('Median') & CarbonANDCarbonates.data$ANALYSIS == c('Soil TOC (Combustion)')),]  ;
tail(TOC)
TC<-CarbonANDCarbonates.data[which(CarbonANDCarbonates.data$TYPE == c('Median') & CarbonANDCarbonates.data$ANALYSIS == c('Soil Total C (Combustion)')),]  ;
tail(TC)
SOM_Walkley<-CarbonANDCarbonates.data[which(CarbonANDCarbonates.data$TYPE == c('Median') & CarbonANDCarbonates.data$ANALYSIS == c('SOM - Walkley-Black')),]  ;
tail(SOM_Walkley)
CaCO3<-CarbonANDCarbonates.data[which(CarbonANDCarbonates.data$TYPE == c('Median') & CarbonANDCarbonates.data$ANALYSIS == c('CaCO3 Content')),]  ;
tail(CaCO3)
SCC.Data.0
head(SCC.Data.0)
SRS_1604_SRS_1508<-readWorksheetFromFile("Results_data_all.xlsx", sheet="Carbon and carbonatesOriginal", header=T, startRow=1, endRow=17, startCol=38, endCol=43 ) ;
SCC.Data.all<-rbind(SCC.Data.0, SRS_1604_SRS_1508)
tail(SCC.Data.all,20)
CarbonANDCarbonates.data<-SCC.Data.all[-c(1:10),] ;
CarbonANDCarbonates.data$Sample.ID<-paste0(CarbonANDCarbonates.data$YEAR,"-",CarbonANDCarbonates.data$SAMPLE) ;
CarbonANDCarbonates.noMAD.data<-CarbonANDCarbonates.data[which(CarbonANDCarbonates.data$TYPE == c('Median')),] ;
str(CarbonANDCarbonates.noMAD.data)
head(CarbonANDCarbonates.noMAD.data)
tail(CarbonANDCarbonates.noMAD.data)
levels(CarbonANDCarbonates.noMAD.data$ANALYSIS)
TOC<-CarbonANDCarbonates.data[which(CarbonANDCarbonates.data$TYPE == c('Median') & CarbonANDCarbonates.data$ANALYSIS == c('Soil TOC (Combustion)')),]  ;
TC<-CarbonANDCarbonates.data[which(CarbonANDCarbonates.data$TYPE == c('Median') & CarbonANDCarbonates.data$ANALYSIS == c('Soil Total C (Combustion)')),]  ;
SOM_Walkley<-CarbonANDCarbonates.data[which(CarbonANDCarbonates.data$TYPE == c('Median') & CarbonANDCarbonates.data$ANALYSIS == c('SOM - Walkley-Black')),]  ;
SOM_LOI<-CarbonANDCarbonates.data[which(CarbonANDCarbonates.data$TYPE == c('Median') & CarbonANDCarbonates.data$ANALYSIS == c('SOM - LOI (% Wt loss)')),]  ;
CaCO3<-CarbonANDCarbonates.data[which(CarbonANDCarbonates.data$TYPE == c('Median') & CarbonANDCarbonates.data$ANALYSIS == c('CaCO3 Content')),]  ;
tail(CaCO3)
SoilCarbonCarbonates<-readWorksheetFromFile("Results_data_all.xlsx", sheet="Carbon and carbonates", header=T, startRow=2) ;
head(SoilCarbonCarbonates)
str(SoilCarbonCarbonates)
i=1
j=1
SCC.Data.0<-data.frame(SoilCarbonCarbonates[j,1], rep(seq(SoilCarbonCarbonates[j,2],SoilCarbonCarbonates[j,3]),each=2), SoilCarbonCarbonates[j,(4+(13*(i-1)))], rep(c('Median', 'MAD'),5),t(SoilCarbonCarbonates[j,seq(7+((i-1)*13),7+9+((i-1)*13))])[,1] , SoilCarbonCarbonates[j,6+((i-1)*13)] ) ;
names(SCC.Data.0)<-c('YEAR' , 'SAMPLE' , 'ANALYSIS' ,'TYPE' , 'VALUE' , 'n');
SCC.Data.0
for (j in seq(1,12))  {
for ( i in seq(1,5) ) {
SCC.Data<-data.frame(SoilCarbonCarbonates[j,1], rep(seq(SoilCarbonCarbonates[j,2],SoilCarbonCarbonates[j,3]),each=2), SoilCarbonCarbonates[j,(4+(13*(i-1)))], rep(c('Median', 'MAD'),5),t(SoilCarbonCarbonates[j,seq(7+((i-1)*13),7+9+((i-1)*13))])[,1] , SoilCarbonCarbonates[j,6+((i-1)*13)] ) ;
names(SCC.Data)<-c('YEAR' , 'SAMPLE' , 'ANALYSIS' ,'TYPE' , 'VALUE' , 'n');
print(SCC.Data)
SCC.Data.1<-rbind(SCC.Data.0,SCC.Data)
SCC.Data.0<-SCC.Data.1
rm(SCC.Data,SCC.Data.1)
}
}
SCC.Data.0
head(SCC.Data.0)
SRS_1604_SRS_1508<-readWorksheetFromFile("Results_data_all.xlsx", sheet="Carbon and carbonatesOriginal", header=T, startRow=1, endRow=17, startCol=38, endCol=43 ) ;
SCC.Data.all<-rbind(SCC.Data.0, SRS_1604_SRS_1508)
tail(SCC.Data.all,20)
writeWorksheetToFile("Results_data_all.xlsx",SCC.Data.all[-c(1:10),], sheet="Carbon and Carbonates table") ;
CarbonANDCarbonates.data<-SCC.Data.all[-c(1:10),] ;
CarbonANDCarbonates.data$Sample.ID<-paste0(CarbonANDCarbonates.data$YEAR,"-",CarbonANDCarbonates.data$SAMPLE) ;
CarbonANDCarbonates.noMAD.data<-CarbonANDCarbonates.data[which(CarbonANDCarbonates.data$TYPE == c('Median')),] ;
str(CarbonANDCarbonates.noMAD.data)
head(CarbonANDCarbonates.noMAD.data)
tail(CarbonANDCarbonates.noMAD.data)
levels(CarbonANDCarbonates.noMAD.data$ANALYSIS)
TOC<-CarbonANDCarbonates.data[which(CarbonANDCarbonates.data$TYPE == c('Median') & CarbonANDCarbonates.data$ANALYSIS == c('Soil TOC (Combustion)')),]  ;
TC<-CarbonANDCarbonates.data[which(CarbonANDCarbonates.data$TYPE == c('Median') & CarbonANDCarbonates.data$ANALYSIS == c('Soil Total C (Combustion)')),]  ;
SOM_Walkley<-CarbonANDCarbonates.data[which(CarbonANDCarbonates.data$TYPE == c('Median') & CarbonANDCarbonates.data$ANALYSIS == c('SOM - Walkley-Black')),]  ;
SOM_LOI<-CarbonANDCarbonates.data[which(CarbonANDCarbonates.data$TYPE == c('Median') & CarbonANDCarbonates.data$ANALYSIS == c('SOM - LOI (% Wt loss)')),]  ;
CaCO3<-CarbonANDCarbonates.data[which(CarbonANDCarbonates.data$TYPE == c('Median') & CarbonANDCarbonates.data$ANALYSIS == c('CaCO3 Content')),]  ;
Soil_C_CaCO3.1<-merge(TOC[,c('ANALYSIS', 'VALUE' , 'Sample.ID')],TC[,c('ANALYSIS', 'VALUE' , 'Sample.ID')] , by="Sample.ID") ;
Soil_C_CaCO3.2<-merge(SOM_Walkley[,c('ANALYSIS', 'VALUE' , 'Sample.ID')],SOM_LOI[,c('ANALYSIS', 'VALUE' , 'Sample.ID')] , by="Sample.ID") ;
Soil_C_CaCO3.3<-merge(Soil_C_CaCO3.2, CaCO3[,c('ANALYSIS', 'VALUE' , 'Sample.ID')] , by="Sample.ID") ;
Soil_C_CaCO3.4<-merge(Soil_C_CaCO3.3, Soil_C_CaCO3.1, by="Sample.ID") ;
head(Soil_C_CaCO3.4)
Soil_C_CaCO3<-Soil_C_CaCO3.4[,c('Sample.ID', 'VALUE.x.x' , 'VALUE.y.x' , 'VALUE' , 'VALUE.x.y' , 'VALUE.y.y')] ;
names(Soil_C_CaCO3)<-c('Sample.ID','SOM - Walkley-Black', 'SOM - LOI (% Wt loss)','CaCO3 Content' ,'Soil TOC (Combustion)' , 'Soil Total C (Combustion)')
head(Soil_C_CaCO3)
tail(Soil_C_CaCO3)
TOC<-CarbonANDCarbonates.data[which(CarbonANDCarbonates.data$TYPE == c('Median') & CarbonANDCarbonates.data$ANALYSIS == c('Soil TOC (Combustion)')),]  ;
tail(TOC)
tail(TC)
tail(SOM_Walkley)
tail(SOM_LOI)
tail(CaCO3)
Soil_C_CaCO3.1<-merge(TOC[,c('ANALYSIS', 'VALUE' , 'Sample.ID')],TC[,c('ANALYSIS', 'VALUE' , 'Sample.ID')] , by="Sample.ID", all= T) ;
Soil_C_CaCO3.2<-merge(SOM_Walkley[,c('ANALYSIS', 'VALUE' , 'Sample.ID')],SOM_LOI[,c('ANALYSIS', 'VALUE' , 'Sample.ID')] , by="Sample.ID", all= T ) ;
Soil_C_CaCO3.3<-merge(Soil_C_CaCO3.2, CaCO3[,c('ANALYSIS', 'VALUE' , 'Sample.ID')] , by="Sample.ID", all= T) ;
Soil_C_CaCO3.4<-merge(Soil_C_CaCO3.3, Soil_C_CaCO3.1, by="Sample.ID", all= T) ;
head(Soil_C_CaCO3.4)
tail(Soil_C_CaCO3.4)
Soil_C_CaCO3<-Soil_C_CaCO3.4[,c('Sample.ID', 'VALUE.x.x' , 'VALUE.y.x' , 'VALUE' , 'VALUE.x.y' , 'VALUE.y.y')] ;
names(Soil_C_CaCO3)<-c('Sample.ID','SOM - Walkley-Black', 'SOM - LOI (% Wt loss)','CaCO3 Content' ,'Soil TOC (Combustion)' , 'Soil Total C (Combustion)')
head(Soil_C_CaCO3)
tail(Soil_C_CaCO3)
writeWorksheetToFile("Results_data_all.xlsx",Soil_C_CaCO3, sheet="C_CaCO3") ;
library(XLConnect) ;
NAPT.data<-readWorksheetFromFile("Results_data_all.xlsx", sheet="Combined", startRow=1, endRow=864) ;
str(NAPT.data)
head(NAPT.data)
NAPT.data.head<-NAPT.data[c(1,2),] ;
NAPT.data.nohead<-NAPT.data[-c(1,2),] ;
NAPT.data.nohead$SAMPLE<-str_split(str_split(NAPT.data.nohead$X, " ", simplify = T)[,2], "_" ,simplify = T)[,1] ;
NAPT.data.nohead$VALUE<-str_split(str_split(NAPT.data.nohead$X, " ", simplify = T)[,2], "_" ,simplify = T)[,2] ;
NAPT.data.nohead.n_rows<-which(NAPT.data.nohead[,1] == 'n', arr.ind = T)  ;
NAPT.data.nohead[NAPT.data.nohead.n_rows, 'SAMPLE']<-NAPT.data.nohead[NAPT.data.nohead.n_rows+1, 'SAMPLE'] ;
NAPT.data.nohead[NAPT.data.nohead.n_rows, 'VALUE']<-NAPT.data.nohead[NAPT.data.nohead.n_rows, 'X'] ;
str(NAPT.data.nohead)
head(NAPT.data.nohead)
NAPT.data.Median<-NAPT.data.nohead[NAPT.data.nohead$VALUE == 'Median',]
str(NAPT.data.Median)
head(NAPT.data.Median)
NAPT.data.MAD<-NAPT.data.nohead[NAPT.data.nohead$VALUE == 'MAD',]
str(NAPT.data.MAD)
head(NAPT.data.MAD)
NAPT.data.n<-NAPT.data.nohead[NAPT.data.nohead$VALUE == 'n',]
str(NAPT.data.n)
head(NAPT.data.n)
NAPT.Texture<-merge(NAPT.data.Median,NAPT.data.MAD, by= 'SAMPLE')
str(NAPT.Texture)
head(NAPT.Texture,30)
NAPT.Texture[which(!is.na(NAPT.Texture$V4.x)),]
NAPT.Texture$ANALYSIS<-'PLACEHOLDER'  ;
NAPT.Texture[which(!is.na(NAPT.Texture$V4.x)),'ANALYSIS']<- 'Pipette'  ;
NAPT.Texture[which(is.na(NAPT.Texture$V4.x)),'ANALYSIS']<- 'Hydrometer'  ;
NAPT.Texture.Hydrom<-NAPT.Texture[,c(1,2,3,4,5,9)] ;
str(NAPT.Texture)
head(NAPT.Texture,10)
tail(NAPT.Texture,10)
names(NAPT.Texture)<-c('SAMPLE' ,' NAME','SAND_Med' , 'SILT_Med' , 'CLAY_Med','SAND_Med' , 'SILT_Med' , 'CLAY_Med', 'VALUE.X', 'NAME_2' , 'SAND_MAD' , 'SILT_MAD' , 'CLAY_MAD','SAND_MAD' , 'SILT_MAD' , 'CLAY_MAD' , 'VALUE.Y', 'ANALYSIS') ;
NAPT.Texture.Hydrometer<-NAPT.Texture[which(NAPT.Texture$ANALYSIS == 'Hydrometer'), c(1,3,4,5,11,12,13,18)] ;
NAPT.Texture.Pipette<-NAPT.Texture[which(NAPT.Texture$ANALYSIS == 'Pipette'), c(1,6,7,8,14,15,16,18)] ;
NAPT.all<-rbind(NAPT.Texture.Hydrometer,NAPT.Texture.Pipette)
str(NAPT.all)
head(NAPT.all,20)
tail(NAPT.all,20)
NAPT.all[which(NAPT.all$ANALYSIS == 'Pipette'),]
NAPT.Texture.data<-data.frame(as.numeric(NAPT.all$SAND_Med),as.numeric(NAPT.all$SILT_Med),as.numeric(NAPT.all$CLAY_Med),as.numeric(NAPT.all$SAND_MAD),as.numeric(NAPT.all$SILT_MAD),as.numeric(NAPT.all$CLAY_MAD), NAPT.all$SAMPLE, NAPT.all$ANALYSIS) ;
str(NAPT.Texture.data)
names(NAPT.Texture.data)[c(1:6)]<-c('SAND' , 'SILT' , 'CLAY', 'MAD_SAND' , 'MAD_SILT' , 'MAD_CLAY') ;
head(NAPT.Texture.data)
str(NAPT.Texture.data)
which(is.na(NAPT.Texture.data$SAND))
NAPT.Texture.data.norm<-TT.normalise.sum(NAPT.Texture.data)  ;
which(is.na.data.frame(NAPT.Texture.data.norm),arr.ind = T)
NAPT<-data.frame(NAPT.Texture.data.norm,NAPT.Texture.data)  ;
names(NAPT)[c(10,11)]<-c('SAMPLE' , 'ANALYSIS') ;
head(NAPT)
ALLP.data.1<-readWorksheetFromFile("Results_data_all.xlsx", sheet="ALP",startCol= 1, endCol=7) ;
str(ALLP.data.1)
head(ALLP.data.1)
ALLP.data.2<-ALLP.data.1[,c('Sand_Mean' , 'Silt_Mean' , 'Clay_Mean', 'Sand_MAD' ,'Silt_MAD' , 'Clay_MAD' ,'Sample')] ;
names(ALLP.data.2)<-c('SAND' , 'SILT' , 'CLAY', 'MAD_SAND' , 'MAD_SILT' , 'MAD_CLAY', 'SAMPLE')  ;
ALLP.norm<-TT.normalise.sum(ALLP.data.2)   ;
ALLP<-data.frame(ALLP.norm,ALLP.data.2 )  ;
str(ALLP)
head(ALLP)
# Soil organic Matter and Carbonates were copied into an excell sheet and then read into R for formatting  ###
SoilCarbonCarbonates<-readWorksheetFromFile("Results_data_all.xlsx", sheet="Carbon and carbonates", header=T, startRow=2) ;
head(SoilCarbonCarbonates)
str(SoilCarbonCarbonates)
# SCC.t<-data.frame(t(SoilCarbonCarbonates[,7:16]), stringsAsFactors = F);
# str(SCC.t)
#rep(seq(SoilCarbonCarbonates[2,2],SoilCarbonCarbonates[2,3]),each=2)
########### Going  along the analysis direction (Horizontal)  First and then along the year (vertical) second  #########
i=1
j=1
SCC.Data.0<-data.frame(SoilCarbonCarbonates[j,1], rep(seq(SoilCarbonCarbonates[j,2],SoilCarbonCarbonates[j,3]),each=2), SoilCarbonCarbonates[j,(4+(13*(i-1)))], rep(c('Median', 'MAD'),5),t(SoilCarbonCarbonates[j,seq(7+((i-1)*13),7+9+((i-1)*13))])[,1] , SoilCarbonCarbonates[j,6+((i-1)*13)] ) ;
names(SCC.Data.0)<-c('YEAR' , 'SAMPLE' , 'ANALYSIS' ,'TYPE' , 'VALUE' , 'n');
SCC.Data.0
for (j in seq(1,12))  {
for ( i in seq(1,5) ) {
SCC.Data<-data.frame(SoilCarbonCarbonates[j,1], rep(seq(SoilCarbonCarbonates[j,2],SoilCarbonCarbonates[j,3]),each=2), SoilCarbonCarbonates[j,(4+(13*(i-1)))], rep(c('Median', 'MAD'),5),t(SoilCarbonCarbonates[j,seq(7+((i-1)*13),7+9+((i-1)*13))])[,1] , SoilCarbonCarbonates[j,6+((i-1)*13)] ) ;
names(SCC.Data)<-c('YEAR' , 'SAMPLE' , 'ANALYSIS' ,'TYPE' , 'VALUE' , 'n');
print(SCC.Data)
SCC.Data.1<-rbind(SCC.Data.0,SCC.Data)
SCC.Data.0<-SCC.Data.1
rm(SCC.Data,SCC.Data.1)
}
}
SCC.Data.0
head(SCC.Data.0)
SRS_1604_SRS_1508_SRS1709<-readWorksheetFromFile("Results_data_all.xlsx", sheet="Carbon and carbonatesOriginal", header=T, startRow=1, endRow=25, startCol=38, endCol=43 ) ;
SCC.Data.all<-rbind(SCC.Data.0, SRS_1604_SRS_1508)
tail(SCC.Data.all,20)
SRS_Samples
SRS_Samples<-readWorksheetFromFile("Results_data_all.xlsx", sheet="Carbon and carbonatesOriginal", header=T, startRow=1, endRow=25, startCol=38, endCol=43 ) ;
SCC.Data.all<-rbind(SCC.Data.0, SRS_Samples)
SRS_Samples<-readWorksheetFromFile("Results_data_all.xlsx", sheet="Carbon and carbonatesOriginal", header=T, startRow=1, endRow=25, startCol=38, endCol=43 ) ;
SRS_Samples
SRS_Samples<-readWorksheetFromFile("Results_data_all.xlsx", sheet="Carbon and carbonatesOriginal", header=T, startRow=1, endRow=25, startCol=35, endCol=40 ) ;
SRS_Samples
SCC.Data.all<-rbind(SCC.Data.0, SRS_Samples)
tail(SCC.Data.all,20)
tail(SCC.Data.all,30)
writeWorksheetToFile("Results_data_all.xlsx",SCC.Data.all[-c(1:10),], sheet="Carbon and Carbonates table") ;
CarbonANDCarbonates.data<-SCC.Data.all[-c(1:10),] ;
CarbonANDCarbonates.data$Sample.ID<-paste0(CarbonANDCarbonates.data$YEAR,"-",CarbonANDCarbonates.data$SAMPLE) ;
CarbonANDCarbonates.noMAD.data<-CarbonANDCarbonates.data[which(CarbonANDCarbonates.data$TYPE == c('Median')),] ;
str(CarbonANDCarbonates.noMAD.data)
head(CarbonANDCarbonates.noMAD.data)
tail(CarbonANDCarbonates.noMAD.data)
levels(CarbonANDCarbonates.noMAD.data$ANALYSIS)
TOC<-CarbonANDCarbonates.data[which(CarbonANDCarbonates.data$TYPE == c('Median') & CarbonANDCarbonates.data$ANALYSIS == c('Soil TOC (Combustion)')),]  ;
TC<-CarbonANDCarbonates.data[which(CarbonANDCarbonates.data$TYPE == c('Median') & CarbonANDCarbonates.data$ANALYSIS == c('Soil Total C (Combustion)')),]  ;
SOM_Walkley<-CarbonANDCarbonates.data[which(CarbonANDCarbonates.data$TYPE == c('Median') & CarbonANDCarbonates.data$ANALYSIS == c('SOM - Walkley-Black')),]  ;
SOM_LOI<-CarbonANDCarbonates.data[which(CarbonANDCarbonates.data$TYPE == c('Median') & CarbonANDCarbonates.data$ANALYSIS == c('SOM - LOI (% Wt loss)')),]  ;
CaCO3<-CarbonANDCarbonates.data[which(CarbonANDCarbonates.data$TYPE == c('Median') & CarbonANDCarbonates.data$ANALYSIS == c('CaCO3 Content')),]  ;
Soil_C_CaCO3.1<-merge(TOC[,c('ANALYSIS', 'VALUE' , 'Sample.ID')],TC[,c('ANALYSIS', 'VALUE' , 'Sample.ID')] , by="Sample.ID", all= T) ;
Soil_C_CaCO3.2<-merge(SOM_Walkley[,c('ANALYSIS', 'VALUE' , 'Sample.ID')],SOM_LOI[,c('ANALYSIS', 'VALUE' , 'Sample.ID')] , by="Sample.ID", all= T ) ;
Soil_C_CaCO3.3<-merge(Soil_C_CaCO3.2, CaCO3[,c('ANALYSIS', 'VALUE' , 'Sample.ID')] , by="Sample.ID", all= T) ;
Soil_C_CaCO3.4<-merge(Soil_C_CaCO3.3, Soil_C_CaCO3.1, by="Sample.ID", all= T) ;
head(Soil_C_CaCO3.4)
tail(Soil_C_CaCO3.4)
Soil_C_CaCO3<-Soil_C_CaCO3.4[,c('Sample.ID', 'VALUE.x.x' , 'VALUE.y.x' , 'VALUE' , 'VALUE.x.y' , 'VALUE.y.y')] ;
names(Soil_C_CaCO3)<-c('Sample.ID','SOM - Walkley-Black', 'SOM - LOI (% Wt loss)','CaCO3 Content' ,'Soil TOC (Combustion)' , 'Soil Total C (Combustion)')
head(Soil_C_CaCO3)
tail(Soil_C_CaCO3)
tail(Soil_C_CaCO3,20)
writeWorksheetToFile("Results_data_all.xlsx",Soil_C_CaCO3, sheet="C_CaCO3") ;
SoilCarbonCarbonates<-readWorksheetFromFile("Results_data_all.xlsx", sheet="Carbon and carbonates", header=T, startRow=2) ;
head(SoilCarbonCarbonates)
str(SoilCarbonCarbonates)
i=1
j=1
SCC.Data.0<-data.frame(SoilCarbonCarbonates[j,1], rep(seq(SoilCarbonCarbonates[j,2],SoilCarbonCarbonates[j,3]),each=2), SoilCarbonCarbonates[j,(4+(13*(i-1)))], rep(c('Median', 'MAD'),5),t(SoilCarbonCarbonates[j,seq(7+((i-1)*13),7+9+((i-1)*13))])[,1] , SoilCarbonCarbonates[j,6+((i-1)*13)] ) ;
names(SCC.Data.0)<-c('YEAR' , 'SAMPLE' , 'ANALYSIS' ,'TYPE' , 'VALUE' , 'n');
SCC.Data.0
for (j in seq(1,12))  {
for ( i in seq(1,5) ) {
SCC.Data<-data.frame(SoilCarbonCarbonates[j,1], rep(seq(SoilCarbonCarbonates[j,2],SoilCarbonCarbonates[j,3]),each=2), SoilCarbonCarbonates[j,(4+(13*(i-1)))], rep(c('Median', 'MAD'),5),t(SoilCarbonCarbonates[j,seq(7+((i-1)*13),7+9+((i-1)*13))])[,1] , SoilCarbonCarbonates[j,6+((i-1)*13)] ) ;
names(SCC.Data)<-c('YEAR' , 'SAMPLE' , 'ANALYSIS' ,'TYPE' , 'VALUE' , 'n');
print(SCC.Data)
SCC.Data.1<-rbind(SCC.Data.0,SCC.Data)
SCC.Data.0<-SCC.Data.1
rm(SCC.Data,SCC.Data.1)
}
}
SCC.Data.0
head(SCC.Data.0)
SRS_Samples<-readWorksheetFromFile("Results_data_all.xlsx", sheet="Carbon and carbonatesOriginal", header=T, startRow=1, endRow=25, startCol=35, endCol=40 ) ;
SCC.Data.all<-rbind(SCC.Data.0, SRS_Samples)
tail(SCC.Data.all,30)
SRS_Samples
SRS_Samples<-readWorksheetFromFile("Results_data_all.xlsx", sheet="Carbon and carbonatesOriginal", header=T, startRow=1, endRow=25, startCol=42, endCol=47 ) ;
SRS_Samples
SCC.Data.all<-rbind(SCC.Data.0, SRS_Samples)
SRS_Samples<-readWorksheetFromFile("Results_data_all.xlsx", sheet="Carbon and carbonatesOriginal", header=T, startRow=1, endRow=25, startCol=42, endCol=48 ) ;
SRS_Samples
SCC.Data.all<-rbind(SCC.Data.0, SRS_Samples)
tail(SCC.Data.all,30)
writeWorksheetToFile("Results_data_all.xlsx",SCC.Data.all[-c(1:10),], sheet="Carbon and Carbonates table") ;
CarbonANDCarbonates.data<-SCC.Data.all[-c(1:10),] ;
CarbonANDCarbonates.data$Sample.ID<-paste0(CarbonANDCarbonates.data$YEAR,"-",CarbonANDCarbonates.data$SAMPLE) ;
CarbonANDCarbonates.noMAD.data<-CarbonANDCarbonates.data[which(CarbonANDCarbonates.data$TYPE == c('Median')),] ;
str(CarbonANDCarbonates.noMAD.data)
head(CarbonANDCarbonates.noMAD.data)
tail(CarbonANDCarbonates.noMAD.data)
levels(CarbonANDCarbonates.noMAD.data$ANALYSIS)
TOC<-CarbonANDCarbonates.data[which(CarbonANDCarbonates.data$TYPE == c('Median') & CarbonANDCarbonates.data$ANALYSIS == c('Soil TOC (Combustion)')),]  ;
TC<-CarbonANDCarbonates.data[which(CarbonANDCarbonates.data$TYPE == c('Median') & CarbonANDCarbonates.data$ANALYSIS == c('Soil Total C (Combustion)')),]  ;
SOM_Walkley<-CarbonANDCarbonates.data[which(CarbonANDCarbonates.data$TYPE == c('Median') & CarbonANDCarbonates.data$ANALYSIS == c('SOM - Walkley-Black')),]  ;
SOM_LOI<-CarbonANDCarbonates.data[which(CarbonANDCarbonates.data$TYPE == c('Median') & CarbonANDCarbonates.data$ANALYSIS == c('SOM - LOI (% Wt loss)')),]  ;
CaCO3<-CarbonANDCarbonates.data[which(CarbonANDCarbonates.data$TYPE == c('Median') & CarbonANDCarbonates.data$ANALYSIS == c('CaCO3 Content')),]  ;
Soil_C_CaCO3.1<-merge(TOC[,c('ANALYSIS', 'VALUE' , 'Sample.ID')],TC[,c('ANALYSIS', 'VALUE' , 'Sample.ID')] , by="Sample.ID", all= T) ;
Soil_C_CaCO3.2<-merge(SOM_Walkley[,c('ANALYSIS', 'VALUE' , 'Sample.ID')],SOM_LOI[,c('ANALYSIS', 'VALUE' , 'Sample.ID')] , by="Sample.ID", all= T ) ;
Soil_C_CaCO3.3<-merge(Soil_C_CaCO3.2, CaCO3[,c('ANALYSIS', 'VALUE' , 'Sample.ID')] , by="Sample.ID", all= T) ;
Soil_C_CaCO3.4<-merge(Soil_C_CaCO3.3, Soil_C_CaCO3.1, by="Sample.ID", all= T) ;
head(Soil_C_CaCO3.4)
tail(Soil_C_CaCO3.4)
Soil_C_CaCO3<-Soil_C_CaCO3.4[,c('Sample.ID', 'VALUE.x.x' , 'VALUE.y.x' , 'VALUE' , 'VALUE.x.y' , 'VALUE.y.y')] ;
names(Soil_C_CaCO3)<-c('Sample.ID','SOM - Walkley-Black', 'SOM - LOI (% Wt loss)','CaCO3 Content' ,'Soil TOC (Combustion)' , 'Soil Total C (Combustion)')
head(Soil_C_CaCO3)
tail(Soil_C_CaCO3,20)
writeWorksheetToFile("Results_data_all.xlsx",Soil_C_CaCO3, sheet="C_CaCO3") ;
getwd()
Giovani_C_CaCO3<-readWorksheetFromFile("../Manuscript/Location of samples completed FM 20180629.xlsx", header=T ) ;
readWorksheetFromFile("../Manuscript/Location of samples completed FM 20180629.xlsx", header=T )
Giovani_C_CaCO3<-readWorksheetFromFile("../Manuscript/Location of samples completed FM 20180629.xlsx", 'Sheet1', header=T ) ;
Giovani_C_CaCO3
str(Giovani_C_CaCO3)
which(Giovani_C_CaCO3$Sample %in% Soil_C_CaCO3$Sample.ID)
Giovani_C_CaCO3[which(Giovani_C_CaCO3$Sample %in% Soil_C_CaCO3$Sample.ID),]
Giovani_C_CaCO3[!which(Giovani_C_CaCO3$Sample %in% Soil_C_CaCO3$Sample.ID),]
which(Giovani_C_CaCO3$Sample !%in% Soil_C_CaCO3$Sample.ID)
!which(Giovani_C_CaCO3$Sample %in% Soil_C_CaCO3$Sample.ID)
str(Giovani_C_CaCO3)
Soil_C_CaCO3[which(Soil_C_CaCO3$Sample.ID %in% Giovani_C_CaCO3$Sample),]
Soil_C_CaCO3[!which(Soil_C_CaCO3$Sample.ID %in% Giovani_C_CaCO3$Sample),]
which(Soil_C_CaCO3$Sample.ID %in% Giovani_C_CaCO3$Sample, arr.ind = T)
Soil_C_CaCO3[!which(Soil_C_CaCO3$Sample.ID %in% Giovani_C_CaCO3$Sample, arr.ind = T),]
Giovani_C_CaCO3$Sample
Soil_C_CaCO3$Sample.ID
which(Soil_C_CaCO3$Sample.ID %in% Giovani_C_CaCO3$Sample
which(Soil_C_CaCO3$Sample.ID %in% Giovani_C_CaCO3$Sample, arr.ind = T)
which(Soil_C_CaCO3$Sample.ID %in% Giovani_C_CaCO3$Sample, arr.ind = T)
subset(Giovani_C_CaCO3,[which(Soil_C_CaCO3$Sample.ID %in% Giovani_C_CaCO3$Sample, arr.ind = T),]
Giovani_C_CaCO3<-[which(Soil_C_CaCO3$Sample.ID %in% Giovani_C_CaCO3$Sample, arr.ind = T),]
Giovani_C_CaCO3[which(Soil_C_CaCO3$Sample.ID %in% Giovani_C_CaCO3$Sample),]
Giovani_C_CaCO3[which(Soil_C_CaCO3$Sample.ID %in% Giovani_C_CaCO3$Sample),'Sample']
Giovani_C_CaCO3[!which(Soil_C_CaCO3$Sample.ID %in% Giovani_C_CaCO3$Sample),'Sample']
Giovani_C_CaCO3[which(Soil_C_CaCO3$Sample.ID %in% Giovani_C_CaCO3$Sample),'Sample']
which(Soil_C_CaCO3$Sample.ID %in% Giovani_C_CaCO3$Sample)
Giovani_C_CaCO3$Sample
Soil_C_CaCO3$Sample.ID
Soil_C_CaCO3[which(Soil_C_CaCO3$Sample.ID %in% Giovani_C_CaCO3$Sample),'Sample']
head(Soil_C_CaCO3)
str(Giovani_C_CaCO3)
str(Soil_C_CaCO3)
Soil_C_CaCO3[which(Soil_C_CaCO3$Sample.ID %in% Giovani_C_CaCO3$Sample),'Sample.ID']
Soil_C_CaCO3[which(!Soil_C_CaCO3$Sample.ID %in% Giovani_C_CaCO3$Sample),'Sample.ID']
SoilCarbonCarbonates<-readWorksheetFromFile("Results_data_all.xlsx", sheet="Carbon and carbonates", header=T, startRow=2) ;
SoilCarbonCarbonates<-readWorksheetFromFile("Results_data_all.xlsx", sheet="Carbon and carbonates", header=T, startRow=2) ;
SoilCarbonCarbonates
View(SoilCarbonCarbonates)
View(SoilCarbonCarbonates)
head(SoilCarbonCarbonates)
str(SoilCarbonCarbonates)
i=1
j=1
SCC.Data.0<-data.frame(SoilCarbonCarbonates[j,1], rep(seq(SoilCarbonCarbonates[j,2],SoilCarbonCarbonates[j,3]),each=2), SoilCarbonCarbonates[j,(4+(13*(i-1)))], rep(c('Median', 'MAD'),5),t(SoilCarbonCarbonates[j,seq(7+((i-1)*13),7+9+((i-1)*13))])[,1] , SoilCarbonCarbonates[j,6+((i-1)*13)] ) ;
names(SCC.Data.0)<-c('YEAR' , 'SAMPLE' , 'ANALYSIS' ,'TYPE' , 'VALUE' , 'n');
SCC.Data.0
for (j in seq(1,20))  {
for ( i in seq(1,5) ) {
SCC.Data<-data.frame(SoilCarbonCarbonates[j,1], rep(seq(SoilCarbonCarbonates[j,2],SoilCarbonCarbonates[j,3]),each=2), SoilCarbonCarbonates[j,(4+(13*(i-1)))], rep(c('Median', 'MAD'),5),t(SoilCarbonCarbonates[j,seq(7+((i-1)*13),7+9+((i-1)*13))])[,1] , SoilCarbonCarbonates[j,6+((i-1)*13)] ) ;
names(SCC.Data)<-c('YEAR' , 'SAMPLE' , 'ANALYSIS' ,'TYPE' , 'VALUE' , 'n');
print(SCC.Data)
SCC.Data.1<-rbind(SCC.Data.0,SCC.Data)
SCC.Data.0<-SCC.Data.1
rm(SCC.Data,SCC.Data.1)
}
}
SCC.Data.0
head(SCC.Data.0)
SRS_Samples<-readWorksheetFromFile("Results_data_all.xlsx", sheet="Carbon and carbonatesOriginal", header=T, startRow=1, endRow=25, startCol=42, endCol=48 ) ;
SCC.Data.all<-rbind(SCC.Data.0, SRS_Samples)
tail(SCC.Data.all,30)
writeWorksheetToFile("Results_data_all.xlsx",SCC.Data.all[-c(1:10),], sheet="Carbon and Carbonates table") ;
writeWorksheetToFile("Results_data_all.xlsx",SCC.Data.all[-c(1:10),], sheet="Carbon and Carbonates table") ;
CarbonANDCarbonates.data<-SCC.Data.all[-c(1:10),] ;
CarbonANDCarbonates.data$Sample.ID<-paste0(CarbonANDCarbonates.data$YEAR,"-",CarbonANDCarbonates.data$SAMPLE) ;
CarbonANDCarbonates.noMAD.data<-CarbonANDCarbonates.data[which(CarbonANDCarbonates.data$TYPE == c('Median')),] ;
str(CarbonANDCarbonates.noMAD.data)
head(CarbonANDCarbonates.noMAD.data)
tail(CarbonANDCarbonates.noMAD.data)
levels(CarbonANDCarbonates.noMAD.data$ANALYSIS)
TOC<-CarbonANDCarbonates.data[which(CarbonANDCarbonates.data$TYPE == c('Median') & CarbonANDCarbonates.data$ANALYSIS == c('Soil TOC (Combustion)')),]  ;
TC<-CarbonANDCarbonates.data[which(CarbonANDCarbonates.data$TYPE == c('Median') & CarbonANDCarbonates.data$ANALYSIS == c('Soil Total C (Combustion)')),]  ;
SOM_Walkley<-CarbonANDCarbonates.data[which(CarbonANDCarbonates.data$TYPE == c('Median') & CarbonANDCarbonates.data$ANALYSIS == c('SOM - Walkley-Black')),]  ;
SOM_LOI<-CarbonANDCarbonates.data[which(CarbonANDCarbonates.data$TYPE == c('Median') & CarbonANDCarbonates.data$ANALYSIS == c('SOM - LOI (% Wt loss)')),]  ;
CaCO3<-CarbonANDCarbonates.data[which(CarbonANDCarbonates.data$TYPE == c('Median') & CarbonANDCarbonates.data$ANALYSIS == c('CaCO3 Content')),]  ;
Soil_C_CaCO3.1<-merge(TOC[,c('ANALYSIS', 'VALUE' , 'Sample.ID')],TC[,c('ANALYSIS', 'VALUE' , 'Sample.ID')] , by="Sample.ID", all= T) ;
Soil_C_CaCO3.2<-merge(SOM_Walkley[,c('ANALYSIS', 'VALUE' , 'Sample.ID')],SOM_LOI[,c('ANALYSIS', 'VALUE' , 'Sample.ID')] , by="Sample.ID", all= T ) ;
Soil_C_CaCO3.3<-merge(Soil_C_CaCO3.2, CaCO3[,c('ANALYSIS', 'VALUE' , 'Sample.ID')] , by="Sample.ID", all= T) ;
Soil_C_CaCO3.4<-merge(Soil_C_CaCO3.3, Soil_C_CaCO3.1, by="Sample.ID", all= T) ;
head(Soil_C_CaCO3.4)
tail(Soil_C_CaCO3.4)
Soil_C_CaCO3<-Soil_C_CaCO3.4[,c('Sample.ID', 'VALUE.x.x' , 'VALUE.y.x' , 'VALUE' , 'VALUE.x.y' , 'VALUE.y.y')] ;
names(Soil_C_CaCO3)<-c('Sample.ID','SOM - Walkley-Black', 'SOM - LOI (% Wt loss)','CaCO3 Content' ,'Soil TOC (Combustion)' , 'Soil Total C (Combustion)')
head(Soil_C_CaCO3)
tail(Soil_C_CaCO3,20)
writeWorksheetToFile("Results_data_all.xlsx",Soil_C_CaCO3, sheet="C_CaCO3") ;
Giovani_C_CaCO3<-readWorksheetFromFile("../Manuscript/Location of samples completed FM 20180629.xlsx", 'Sheet1', header=T ) ;
str(Giovani_C_CaCO3)
str(Soil_C_CaCO3)
Soil_C_CaCO3[which(!Soil_C_CaCO3$Sample.ID %in% Giovani_C_CaCO3$Sample),'Sample.ID']
i=1
j=1
SCC.Data.0<-data.frame(SoilCarbonCarbonates[j,1], rep(seq(SoilCarbonCarbonates[j,2],SoilCarbonCarbonates[j,3]),each=2), SoilCarbonCarbonates[j,(4+(13*(i-1)))], rep(c('Median', 'MAD'),5),t(SoilCarbonCarbonates[j,seq(7+((i-1)*13),7+9+((i-1)*13))])[,1] , SoilCarbonCarbonates[j,6+((i-1)*13)] ) ;
names(SCC.Data.0)<-c('YEAR' , 'SAMPLE' , 'ANALYSIS' ,'TYPE' , 'VALUE' , 'n');
SCC.Data.0
for (j in seq(1,20))  {
for ( i in seq(1,5) ) {
SCC.Data<-data.frame(SoilCarbonCarbonates[j,1], rep(seq(SoilCarbonCarbonates[j,2],SoilCarbonCarbonates[j,3]),each=2), SoilCarbonCarbonates[j,(4+(13*(i-1)))], rep(c('Median', 'MAD'),5),t(SoilCarbonCarbonates[j,seq(7+((i-1)*13),7+9+((i-1)*13))])[,1] , SoilCarbonCarbonates[j,6+((i-1)*13)] ) ;
names(SCC.Data)<-c('YEAR' , 'SAMPLE' , 'ANALYSIS' ,'TYPE' , 'VALUE' , 'n');
print(SCC.Data)
SCC.Data.1<-rbind(SCC.Data.0,SCC.Data)
SCC.Data.0<-SCC.Data.1
rm(SCC.Data,SCC.Data.1)
}
}
SCC.Data.0
head(SCC.Data.0)
SRS_Samples<-readWorksheetFromFile("Results_data_all.xlsx", sheet="Carbon and carbonatesOriginal", header=T, startRow=1, endRow=25, startCol=42, endCol=48 ) ;
SCC.Data.all<-rbind(SCC.Data.0, SRS_Samples)
tail(SCC.Data.all,30)
writeWorksheetToFile("Results_data_all.xlsx",SCC.Data.all[-c(1:10),], sheet="Carbon and Carbonates table") ;
CarbonANDCarbonates.data<-SCC.Data.all[-c(1:10),] ;
CarbonANDCarbonates.data$Sample.ID<-paste0(CarbonANDCarbonates.data$YEAR,"-",CarbonANDCarbonates.data$SAMPLE) ;
CarbonANDCarbonates.noMAD.data<-CarbonANDCarbonates.data[which(CarbonANDCarbonates.data$TYPE == c('Median')),] ;
str(CarbonANDCarbonates.noMAD.data)
head(CarbonANDCarbonates.noMAD.data)
tail(CarbonANDCarbonates.noMAD.data)
levels(CarbonANDCarbonates.noMAD.data$ANALYSIS)
TOC<-CarbonANDCarbonates.data[which(CarbonANDCarbonates.data$TYPE == c('Median') & CarbonANDCarbonates.data$ANALYSIS == c('Soil TOC (Combustion)')),]  ;
TC<-CarbonANDCarbonates.data[which(CarbonANDCarbonates.data$TYPE == c('Median') & CarbonANDCarbonates.data$ANALYSIS == c('Soil Total C (Combustion)')),]  ;
SOM_Walkley<-CarbonANDCarbonates.data[which(CarbonANDCarbonates.data$TYPE == c('Median') & CarbonANDCarbonates.data$ANALYSIS == c('SOM - Walkley-Black')),]  ;
SOM_LOI<-CarbonANDCarbonates.data[which(CarbonANDCarbonates.data$TYPE == c('Median') & CarbonANDCarbonates.data$ANALYSIS == c('SOM - LOI (% Wt loss)')),]  ;
CaCO3<-CarbonANDCarbonates.data[which(CarbonANDCarbonates.data$TYPE == c('Median') & CarbonANDCarbonates.data$ANALYSIS == c('CaCO3 Content')),]  ;
Soil_C_CaCO3.1<-merge(TOC[,c('ANALYSIS', 'VALUE' , 'Sample.ID')],TC[,c('ANALYSIS', 'VALUE' , 'Sample.ID')] , by="Sample.ID", all= T) ;
Soil_C_CaCO3.2<-merge(SOM_Walkley[,c('ANALYSIS', 'VALUE' , 'Sample.ID')],SOM_LOI[,c('ANALYSIS', 'VALUE' , 'Sample.ID')] , by="Sample.ID", all= T ) ;
Soil_C_CaCO3.3<-merge(Soil_C_CaCO3.2, CaCO3[,c('ANALYSIS', 'VALUE' , 'Sample.ID')] , by="Sample.ID", all= T) ;
Soil_C_CaCO3.4<-merge(Soil_C_CaCO3.3, Soil_C_CaCO3.1, by="Sample.ID", all= T) ;
head(Soil_C_CaCO3.4)
tail(Soil_C_CaCO3.4)
Soil_C_CaCO3<-Soil_C_CaCO3.4[,c('Sample.ID', 'VALUE.x.x' , 'VALUE.y.x' , 'VALUE' , 'VALUE.x.y' , 'VALUE.y.y')] ;
names(Soil_C_CaCO3)<-c('Sample.ID','SOM - Walkley-Black', 'SOM - LOI (% Wt loss)','CaCO3 Content' ,'Soil TOC (Combustion)' , 'Soil Total C (Combustion)')
head(Soil_C_CaCO3)
tail(Soil_C_CaCO3,20)
writeWorksheetToFile("Results_data_all.xlsx",Soil_C_CaCO3, sheet="C_CaCO3",) ;
writeWorksheetToFile("Results_data_all.xlsx",Soil_C_CaCO3, sheet="C_CaCO3") ;
Giovani_C_CaCO3<-readWorksheetFromFile("../Manuscript/Location of samples completed FM 20180629.xlsx", 'Sheet1', header=T ) ;
str(Giovani_C_CaCO3)
str(Soil_C_CaCO3)
Soil_C_CaCO3[which(!Soil_C_CaCO3$Sample.ID %in% Giovani_C_CaCO3$Sample),'Sample.ID']
SoilCarbonCarbonates<-readWorksheetFromFile("Results_data_all.xlsx", sheet="Carbon and carbonates", header=T, startRow=2) ;
head(SoilCarbonCarbonates)
str(SoilCarbonCarbonates)
i=1
j=1
SCC.Data.0<-data.frame(SoilCarbonCarbonates[j,1], rep(seq(SoilCarbonCarbonates[j,2],SoilCarbonCarbonates[j,3]),each=2), SoilCarbonCarbonates[j,(4+(13*(i-1)))], rep(c('Median', 'MAD'),5),t(SoilCarbonCarbonates[j,seq(7+((i-1)*13),7+9+((i-1)*13))])[,1] , SoilCarbonCarbonates[j,6+((i-1)*13)] ) ;
names(SCC.Data.0)<-c('YEAR' , 'SAMPLE' , 'ANALYSIS' ,'TYPE' , 'VALUE' , 'n');
SCC.Data.0
for (j in seq(1,20))  {
for ( i in seq(1,5) ) {
SCC.Data<-data.frame(SoilCarbonCarbonates[j,1], rep(seq(SoilCarbonCarbonates[j,2],SoilCarbonCarbonates[j,3]),each=2), SoilCarbonCarbonates[j,(4+(13*(i-1)))], rep(c('Median', 'MAD'),5),t(SoilCarbonCarbonates[j,seq(7+((i-1)*13),7+9+((i-1)*13))])[,1] , SoilCarbonCarbonates[j,6+((i-1)*13)] ) ;
names(SCC.Data)<-c('YEAR' , 'SAMPLE' , 'ANALYSIS' ,'TYPE' , 'VALUE' , 'n');
print(SCC.Data)
SCC.Data.1<-rbind(SCC.Data.0,SCC.Data)
SCC.Data.0<-SCC.Data.1
rm(SCC.Data,SCC.Data.1)
}
}
SCC.Data.0
head(SCC.Data.0)
SRS_Samples<-readWorksheetFromFile("Results_data_all.xlsx", sheet="Carbon and carbonatesOriginal", header=T, startRow=1, endRow=25, startCol=42, endCol=48 ) ;
SCC.Data.all<-rbind(SCC.Data.0, SRS_Samples)
tail(SCC.Data.all,30)
writeWorksheetToFile("Results_data_all.xlsx",SCC.Data.all[-c(1:10),], sheet="Carbon and Carbonates table") ;
CarbonANDCarbonates.data<-SCC.Data.all[-c(1:10),] ;
CarbonANDCarbonates.data$Sample.ID<-paste0(CarbonANDCarbonates.data$YEAR,"-",CarbonANDCarbonates.data$SAMPLE) ;
CarbonANDCarbonates.noMAD.data<-CarbonANDCarbonates.data[which(CarbonANDCarbonates.data$TYPE == c('Median')),] ;
str(CarbonANDCarbonates.noMAD.data)
head(CarbonANDCarbonates.noMAD.data)
tail(CarbonANDCarbonates.noMAD.data)
levels(CarbonANDCarbonates.noMAD.data$ANALYSIS)
TOC<-CarbonANDCarbonates.data[which(CarbonANDCarbonates.data$TYPE == c('Median') & CarbonANDCarbonates.data$ANALYSIS == c('Soil TOC (Combustion)')),]  ;
TC<-CarbonANDCarbonates.data[which(CarbonANDCarbonates.data$TYPE == c('Median') & CarbonANDCarbonates.data$ANALYSIS == c('Soil Total C (Combustion)')),]  ;
SOM_Walkley<-CarbonANDCarbonates.data[which(CarbonANDCarbonates.data$TYPE == c('Median') & CarbonANDCarbonates.data$ANALYSIS == c('SOM - Walkley-Black')),]  ;
SOM_LOI<-CarbonANDCarbonates.data[which(CarbonANDCarbonates.data$TYPE == c('Median') & CarbonANDCarbonates.data$ANALYSIS == c('SOM - LOI (% Wt loss)')),]  ;
CaCO3<-CarbonANDCarbonates.data[which(CarbonANDCarbonates.data$TYPE == c('Median') & CarbonANDCarbonates.data$ANALYSIS == c('CaCO3 Content')),]  ;
Soil_C_CaCO3.1<-merge(TOC[,c('ANALYSIS', 'VALUE' , 'Sample.ID')],TC[,c('ANALYSIS', 'VALUE' , 'Sample.ID')] , by="Sample.ID", all= T) ;
Soil_C_CaCO3.2<-merge(SOM_Walkley[,c('ANALYSIS', 'VALUE' , 'Sample.ID')],SOM_LOI[,c('ANALYSIS', 'VALUE' , 'Sample.ID')] , by="Sample.ID", all= T ) ;
Soil_C_CaCO3.3<-merge(Soil_C_CaCO3.2, CaCO3[,c('ANALYSIS', 'VALUE' , 'Sample.ID')] , by="Sample.ID", all= T) ;
Soil_C_CaCO3.4<-merge(Soil_C_CaCO3.3, Soil_C_CaCO3.1, by="Sample.ID", all= T) ;
head(Soil_C_CaCO3.4)
tail(Soil_C_CaCO3.4)
Soil_C_CaCO3<-Soil_C_CaCO3.4[,c('Sample.ID', 'VALUE.x.x' , 'VALUE.y.x' , 'VALUE' , 'VALUE.x.y' , 'VALUE.y.y')] ;
names(Soil_C_CaCO3)<-c('Sample.ID','SOM - Walkley-Black', 'SOM - LOI (% Wt loss)','CaCO3 Content' ,'Soil TOC (Combustion)' , 'Soil Total C (Combustion)')
head(Soil_C_CaCO3)
tail(Soil_C_CaCO3,20)
writeWorksheetToFile("Results_data_all.xlsx",Soil_C_CaCO3, sheet="C_CaCO3") ;
